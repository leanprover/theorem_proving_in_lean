<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="ascii" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Tactics &#8212; Theorem Proving in Lean 3 (outdated) 3.23.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=5ca61e87" />
    <script src="_static/documentation_options.js?v=5de50469"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Interacting with Lean" href="interacting_with_lean.html" />
    <link rel="prev" title="4. Quantifiers and Equality" href="quantifiers_and_equality.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tactics">
<span id="id1"></span><h1><span class="section-number">5. </span>Tactics<a class="headerlink" href="#tactics" title="Link to this heading">&#182;</a></h1>
<p>In this chapter, we describe an alternative approach to constructing proofs, using <em>tactics</em>. A proof term is a representation of a mathematical proof; tactics are commands, or instructions, that describe how to build such a proof. Informally, we might begin a mathematical proof by saying &#8220;to prove the forward direction, unfold the definition, apply the previous lemma, and simplify.&#8221; Just as these are instructions that tell the reader how to find the relevant proof, tactics are instructions that tell Lean how to construct a proof term. They naturally support an incremental style of writing proofs, in which users decompose a proof and work on goals one step at a time.</p>
<p>We will describe proofs that consist of sequences of tactics as &#8220;tactic-style&#8221; proofs, to contrast with the ways of writing proof terms we have seen so far, which we will call &#8220;term-style&#8221; proofs. Each style has its own advantages and disadvantages. For example, tactic-style proofs can be harder to read, because they require the reader to predict or guess the results of each instruction. But they can also be shorter and easier to write. Moreover, tactics offer a gateway to using Lean&#8217;s automation, since automated procedures are themselves tactics.</p>
<section id="entering-tactic-mode">
<h2><span class="section-number">5.1. </span>Entering Tactic Mode<a class="headerlink" href="#entering-tactic-mode" title="Link to this heading">&#182;</a></h2>
<p>Conceptually, stating a theorem or introducing a <code class="docutils literal notranslate"><span class="pre">have</span></code> statement creates a goal, namely, the goal of constructing a term with the expected type. For example, the following creates the goal of constructing a term of type <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&#8743;</span> <span class="pre">q</span> <span class="pre">&#8743;</span> <span class="pre">p</span></code>, in a context with constants <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">q</span> <span class="pre">:</span> <span class="pre">Prop</span></code>, <code class="docutils literal notranslate"><span class="pre">hp</span> <span class="pre">:</span> <span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">hq</span> <span class="pre">:</span> <span class="pre">q</span></code>:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Asorry" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="gr">sorry</span>
</pre></div>
</div>
</div><p>We can write this goal as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>p : Prop, q : Prop, hp : p, hq : q &#8866; p &#8743; q &#8743; p
</pre></div>
</div>
<p>Indeed, if you replace the &#8220;sorry&#8221; by an underscore in the example above, Lean will report that it is exactly this goal that has been left unsolved.</p>
<p>Ordinarily, we meet such a goal by writing an explicit term. But wherever a term is expected, Lean allows us to insert instead a <code class="docutils literal notranslate"><span class="pre">begin</span> <span class="pre">...</span> <span class="pre">end</span></code> block, followed by a sequence of commands, separated by commas. We can prove the theorem above in that way:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%2C%0A%20%20exact%20hp%2C%0A%20%20apply%20and.intro%2C%0A%20%20exact%20hq%2C%0A%20%20exact%20hp%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">apply</span></code> tactic applies an expression, viewed as denoting a function with zero or more arguments. It unifies the conclusion with the expression in the current goal, and creates new goals for the remaining arguments, provided that no later arguments depend on them. In the example above, the command <code class="docutils literal notranslate"><span class="pre">apply</span> <span class="pre">and.intro</span></code> yields two subgoals:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>p : Prop,
q : Prop,
hp : p,
hq : q
&#8866; p

&#8866; q &#8743; p
</pre></div>
</div>
<p>For brevity, Lean only displays the context for the first goal, which is the one addressed by the next tactic command. The first goal is met with the command <code class="docutils literal notranslate"><span class="pre">exact</span> <span class="pre">hp</span></code>. The <code class="docutils literal notranslate"><span class="pre">exact</span></code> command is just a variant of <code class="docutils literal notranslate"><span class="pre">apply</span></code> which signals that the expression given should fill the goal exactly. It is good form to use it in a tactic proof, since its failure signals that something has gone wrong. It is also more robust than <code class="docutils literal notranslate"><span class="pre">apply</span></code>, since the elaborator takes the expected type, given by the target of the goal, into account when processing the expression that is being applied. In this case, however, <code class="docutils literal notranslate"><span class="pre">apply</span></code> would work just as well.</p>
<p>You can see the resulting proof term with the <code class="docutils literal notranslate"><span class="pre">#print</span></code> command:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%2C%0A%20%20exact%20hp%2C%0A%20%20apply%20and.intro%2C%0A%20%20exact%20hq%2C%0A%20%20exact%20hp%0Aend%0A%0A--%20BEGIN%0A%23print%20test%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#print</span><span class="w"> </span><span class="n">test</span>
</pre></div>
</div>
</div><p>You can write a tactic script incrementally. In VS Code, you can open a window to display messages by pressing <code class="docutils literal notranslate"><span class="pre">Ctrl-Shift-Enter</span></code>, and that window will then show you the current goal whenever the cursor is in a tactic block. In Emacs, you can see the goal at the end of any line by pressing <code class="docutils literal notranslate"><span class="pre">C-c</span> <span class="pre">C-g</span></code>, or see the remaining goal in an incomplete proof by putting the cursor on the <code class="docutils literal notranslate"><span class="pre">end</span></code> symbol.</p>
<p>Tactic commands can take compound expressions, not just single identifiers. The following is a shorter version of the preceding proof:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=--%20BEGIN%0Atheorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Unsurprisingly, it produces exactly the same proof term.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend%0A%0A--%20BEGIN%0A%23print%20test%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="k">#print</span><span class="w"> </span><span class="n">test</span>
</pre></div>
</div>
</div><p>Tactic applications can also be concatenated with a semicolon. Formally speaking, there is only one (compound) step in the following proof:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%3B%20exact%20and.intro%20hq%20hp%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="bp">;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>See <a class="reference internal" href="#tactic-combinators"><span class="std std-numref">Section 5.5</span></a> for a more precise description of the semantics of the semicolon. When a single tactic step can be used to dispell a goal, you can use the <code class="docutils literal notranslate"><span class="pre">by</span></code> keyword instead of using a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=theorem%20test%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Aby%20exact%20and.intro%20hp%20(and.intro%20hq%20hp)" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">(</span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span><span class="o">)</span>
</pre></div>
</div>
</div><p>In VS Code, the tactic state will appear in the messages window whenever the cursor is within the contexts of the <code class="docutils literal notranslate"><span class="pre">by</span></code>. In the Lean Emacs mode, if you put your cursor on the &#8220;b&#8221; in <code class="docutils literal notranslate"><span class="pre">by</span></code> and press <code class="docutils literal notranslate"><span class="pre">C-c</span> <span class="pre">C-g</span></code>, Lean shows you the goal that the tactic is supposed to meet.</p>
<p>We will see below that hypotheses can be introduced, reverted, modified, and renamed over the course of a tactic block. As a result, it is impossible for the Lean parser to detect when an identifier that occurs in a tactic block refers to a section variable that should therefore be added to the context. As a result, you need to explicitly tell Lean to include the relevant entities:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20%7Bp%20q%20%3A%20Prop%7D%20(hp%20%3A%20p)%20(hq%20%3A%20q)%0A%0Ainclude%20hp%20hq%0A%0Aexample%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">{</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span>

<span class="kn">include</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span>

<span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">include</span></code> command tells Lean to include the indicated variables (as well as any variables they depend on) from that point on, until the end of the section or file. To limit the effect of an <code class="docutils literal notranslate"><span class="pre">include</span></code>, you can use the <code class="docutils literal notranslate"><span class="pre">omit</span></code> command afterwards:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20%7Bp%20q%20%3A%20Prop%7D%20(hp%20%3A%20p)%20(hq%20%3A%20q)%0A%0A--%20BEGIN%0Ainclude%20hp%20hq%0A%0Aexample%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend%0A%0Aomit%20hp%20hq%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">include</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span>

<span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>

<span class="kn">omit</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span>
</pre></div>
</div>
</div><p>Thereafter, <code class="docutils literal notranslate"><span class="pre">hp</span></code> and <code class="docutils literal notranslate"><span class="pre">hq</span></code> are no longer included by default. Alternatively, you can use a section to delimit the scope.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20%7Bp%20q%20%3A%20Prop%7D%20(hp%20%3A%20p)%20(hq%20%3A%20q)%0A%0A--%20BEGIN%0Asection%0Ainclude%20hp%20hq%0A%0Aexample%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">section</span>
<span class="kn">include</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span>

<span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Once again, thereafter, <code class="docutils literal notranslate"><span class="pre">hp</span></code> and <code class="docutils literal notranslate"><span class="pre">hq</span></code> are no longer included by default. Another workaround is to find a way to refer to the variable in question before entering a tactic block:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20%7Bp%20q%20%3A%20Prop%7D%20(hp%20%3A%20p)%20(hq%20%3A%20q)%0A%0A--%20BEGIN%0Aexample%20%3A%20p%20%E2%88%A7%20q%20%E2%88%A7%20p%20%3A%3D%0Alet%20hp%20%3A%3D%20hp%2C%20hq%20%3A%3D%20hq%20in%0Abegin%0A%20%20apply%20and.intro%20hp%2C%0A%20%20exact%20and.intro%20hq%20hp%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="k">let</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="k">in</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Any mention of <code class="docutils literal notranslate"><span class="pre">hp</span></code> or <code class="docutils literal notranslate"><span class="pre">hq</span></code> at all outside a tactic block will cause them to be added to the hypotheses.</p>
</section>
<section id="basic-tactics">
<h2><span class="section-number">5.2. </span>Basic Tactics<a class="headerlink" href="#basic-tactics" title="Link to this heading">&#182;</a></h2>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">apply</span></code> and <code class="docutils literal notranslate"><span class="pre">exact</span></code>, another useful tactic is <code class="docutils literal notranslate"><span class="pre">intro</span></code>, which introduces a hypothesis. What follows is an example of an identity from propositional logic that we proved <a class="reference internal" href="propositions_and_proofs.html#examples-of-propositional-validities"><span class="std std-numref">Section 3.6</span></a>, now proved using tactics. We adopt the following convention regarding indentation: whenever a tactic introduces one or more additional subgoals, we indent another two spaces, until the additional subgoals are deleted. That rationale behind this convention, and other structuring mechanisms, will be discussed in <a class="reference internal" href="#structuring-tactic-proofs"><span class="std std-numref">Section 5.4</span></a> below.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%20%20intro%20h%2C%0A%20%20%20%20apply%20or.elim%20(and.right%20h)%2C%0A%20%20%20%20%20%20intro%20hq%2C%0A%20%20%20%20%20%20apply%20or.inl%2C%0A%20%20%20%20%20%20apply%20and.intro%2C%0A%20%20%20%20%20%20%20%20exact%20and.left%20h%2C%0A%20%20%20%20%20%20exact%20hq%2C%0A%20%20%20%20intro%20hr%2C%0A%20%20%20%20apply%20or.inr%2C%0A%20%20%20%20apply%20and.intro%2C%0A%20%20%20%20%20%20exact%20and.left%20h%2C%0A%20%20%20%20exact%20hr%2C%0A%20%20intro%20h%2C%0A%20%20apply%20or.elim%20h%2C%0A%20%20%20%20intro%20hpq%2C%0A%20%20%20%20apply%20and.intro%2C%0A%20%20%20%20%20%20exact%20and.left%20hpq%2C%0A%20%20%20%20apply%20or.inl%2C%0A%20%20%20%20exact%20and.right%20hpq%2C%0A%20%20intro%20hpr%2C%0A%20%20apply%20and.intro%2C%0A%20%20%20%20exact%20and.left%20hpr%2C%0A%20%20apply%20or.inr%2C%0A%20%20exact%20and.right%20hpr%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">or.elim</span><span class="w"> </span><span class="o">(</span><span class="n">and.right</span><span class="w"> </span><span class="n">h</span><span class="o">),</span>
<span class="w">      </span><span class="n">intro</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">      </span><span class="n">apply</span><span class="w"> </span><span class="n">or.inl</span><span class="o">,</span>
<span class="w">      </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">and.left</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">or.inr</span><span class="o">,</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">and.left</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">or.elim</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">and.left</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">or.inl</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">and.right</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">and.intro</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">and.left</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">or.inr</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">and.right</span><span class="w"> </span><span class="n">hpr</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">intro</span></code> command can more generally be used to introduce a variable of any type:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(%CE%B1%20%3A%20Type*)%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%3A%3D%0Abegin%0A%20%20intro%20a%2C%0A%20%20exact%20a%0Aend%0A%0Aexample%20(%CE%B1%20%3A%20Type*)%20%3A%20%E2%88%80%20x%20%3A%20%CE%B1%2C%20x%20%3D%20x%20%3A%3D%0Abegin%0A%20%20intro%20x%2C%0A%20%20exact%20eq.refl%20x%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">a</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">a</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">eq.refl</span><span class="w"> </span><span class="n">x</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>It has a plural form, <code class="docutils literal notranslate"><span class="pre">intros</span></code>, which takes a list of names.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%80%20a%20b%20c%20%3A%20%E2%84%95%2C%20a%20%3D%20b%20%E2%86%92%20a%20%3D%20c%20%E2%86%92%20c%20%3D%20b%20%3A%3D%0Abegin%0A%20%20intros%20a%20b%20c%20h%E2%82%81%20h%E2%82%82%2C%0A%20%20exact%20eq.trans%20(eq.symm%20h%E2%82%82)%20h%E2%82%81%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intros</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">h&#8321;</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">eq.trans</span><span class="w"> </span><span class="o">(</span><span class="n">eq.symm</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">)</span><span class="w"> </span><span class="n">h&#8321;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">intros</span></code> command can also be used without any arguments, in which case, it chooses names and introduces as many variables as it can. We will see an example of this in a moment.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">assumption</span></code> tactic looks through the assumptions in context of the current goal, and if there is one matching the conclusion, it applies it.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=--%20BEGIN%0Avariables%20x%20y%20z%20w%20%3A%20%E2%84%95%0A%0Aexample%20(h%E2%82%81%20%3A%20x%20%3D%20y)%20(h%E2%82%82%20%3A%20y%20%3D%20z)%20(h%E2%82%83%20%3A%20z%20%3D%20w)%20%3A%20x%20%3D%20w%20%3A%3D%0Abegin%0A%20%20apply%20eq.trans%20h%E2%82%81%2C%0A%20%20apply%20eq.trans%20h%E2%82%82%2C%0A%20%20assumption%20%20%20--%20applied%20h%E2%82%83%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">z</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8323;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">w</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="w"> </span><span class="n">h&#8321;</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="w">   </span><span class="c1">-- applied h&#8323;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>It will unify metavariables in the conclusion if necessary:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20x%20y%20z%20w%20%3A%20%E2%84%95%0A%0A--%20BEGIN%0Aexample%20(h%E2%82%81%20%3A%20x%20%3D%20y)%20(h%E2%82%82%20%3A%20y%20%3D%20z)%20(h%E2%82%83%20%3A%20z%20%3D%20w)%20%3A%20x%20%3D%20w%20%3A%3D%0Abegin%0A%20%20apply%20eq.trans%2C%0A%20%20assumption%2C%20%20%20%20%20--%20solves%20x%20%3D%20%3Fm_1%20with%20h%E2%82%81%0A%20%20apply%20eq.trans%2C%0A%20%20assumption%2C%20%20%20%20%20--%20solves%20y%20%3D%20%3Fm_1%20with%20h%E2%82%82%0A%20%20assumption%20%20%20%20%20%20--%20solves%20z%20%3D%20w%20with%20h%E2%82%83%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">z</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8323;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">w</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="o">,</span><span class="w">     </span><span class="c1">-- solves x = ?m_1 with h&#8321;</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="o">,</span><span class="w">     </span><span class="c1">-- solves y = ?m_1 with h&#8322;</span>
<span class="w">  </span><span class="n">assumption</span><span class="w">      </span><span class="c1">-- solves z = w with h&#8323;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The following example uses the <code class="docutils literal notranslate"><span class="pre">intros</span></code> command to introduce the three variables and two hypotheses automatically:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%80%20a%20b%20c%20%3A%20%E2%84%95%2C%20a%20%3D%20b%20%E2%86%92%20a%20%3D%20c%20%E2%86%92%20c%20%3D%20b%20%3A%3D%0Abegin%0A%20%20intros%2C%0A%20%20apply%20eq.trans%2C%0A%20%20apply%20eq.symm%2C%0A%20%20assumption%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intros</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.symm</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>There are tactics <code class="docutils literal notranslate"><span class="pre">reflexivity</span></code>, <code class="docutils literal notranslate"><span class="pre">symmetry</span></code>, and <code class="docutils literal notranslate"><span class="pre">transitivity</span></code>, which apply the corresponding operation. Using reflexivity, for example, is more general than writing <code class="docutils literal notranslate"><span class="pre">apply</span> <span class="pre">eq.refl</span></code>, because it works for any relation that has been tagged with the <code class="docutils literal notranslate"><span class="pre">refl</span></code> attribute. (Attributes will be discussed in <a class="reference internal" href="interacting_with_lean.html#attributes"><span class="std std-numref">Section 6.4</span></a>.) The <code class="docutils literal notranslate"><span class="pre">reflexivity</span></code> tactic can also be abbreviated as <code class="docutils literal notranslate"><span class="pre">refl</span></code>.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(y%20%3A%20%E2%84%95)%20%3A%20(%CE%BB%20x%20%3A%20%E2%84%95%2C%200)%20y%20%3D%200%20%3A%3D%0Abegin%0A%20%20refl%0Aend%0A%0Aexample%20(x%20%3A%20%E2%84%95)%20%3A%20x%20%E2%89%A4%20x%20%3A%3D%0Abegin%0A%20%20refl%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="bp">&#955;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">refl</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&#8804;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">refl</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>With these tactics, the transitivity proof above can be written more elegantly as follows:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%80%20a%20b%20c%20%3A%20%E2%84%95%2C%20a%20%3D%20b%20%E2%86%92%20a%20%3D%20c%20%E2%86%92%20c%20%3D%20b%20%3A%3D%0Abegin%0A%20%20intros%2C%0A%20%20transitivity%2C%0A%20%20symmetry%2C%0A%20%20assumption%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intros</span><span class="o">,</span>
<span class="w">  </span><span class="n">transitivity</span><span class="o">,</span>
<span class="w">  </span><span class="n">symmetry</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In each case, the use of transitivity introduces a metavariable for the middle term, which is then determined by the later tactics. Alternatively, we can send this middle term as an optional argument to <code class="docutils literal notranslate"><span class="pre">transitivity</span></code>:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%80%20a%20b%20c%20%3A%20%E2%84%95%2C%20a%20%3D%20b%20%E2%86%92%20a%20%3D%20c%20%E2%86%92%20c%20%3D%20b%20%3A%3D%0Abegin%0A%20%20intros%20a%20b%20c%20h%E2%82%81%20h%E2%82%82%2C%0A%20%20transitivity%20a%2C%0A%20%20symmetry%2C%0A%20%20assumption%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intros</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">h&#8321;</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">,</span>
<span class="w">  </span><span class="n">transitivity</span><span class="w"> </span><span class="n">a</span><span class="o">,</span>
<span class="w">  </span><span class="n">symmetry</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">repeat</span></code> combinator can be used to simplify the last two lines:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%80%20a%20b%20c%20%3A%20%E2%84%95%2C%20a%20%3D%20b%20%E2%86%92%20a%20%3D%20c%20%E2%86%92%20c%20%3D%20b%20%3A%3D%0Abegin%0A%20%20intros%2C%0A%20%20apply%20eq.trans%2C%0A%20%20apply%20eq.symm%2C%0A%20%20repeat%20%7B%20assumption%20%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intros</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.trans</span><span class="o">,</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">eq.symm</span><span class="o">,</span>
<span class="w">  </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The curly braces introduce a new tactic block; they are equivalent to using a nested <code class="docutils literal notranslate"><span class="pre">begin</span> <span class="pre">...</span> <span class="pre">end</span></code> pair, as discussed in the next section.</p>
<p>If some of the goals that are needed to complete the result of an <code class="docutils literal notranslate"><span class="pre">apply</span></code> depend on others, the <code class="docutils literal notranslate"><span class="pre">apply</span></code> tactic places those subgoals last, in the hopes that they will be solved implicitly by the solutions to the previous subgoals. For example, consider the following proof:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%83%20a%20%3A%20%E2%84%95%2C%205%20%3D%20a%20%3A%3D%0Abegin%0A%20%20apply%20exists.intro%2C%0A%20%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">exists.intro</span><span class="o">,</span>
<span class="w">  </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The first <code class="docutils literal notranslate"><span class="pre">apply</span></code> requires us to construct two values, namely, a value of <code class="docutils literal notranslate"><span class="pre">a</span></code> and a proof that <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">=</span> <span class="pre">a</span></code>. But the <code class="docutils literal notranslate"><span class="pre">apply</span></code> tactic takes the second goal to be the more important one, and places it first. Solving it with reflexivity forces <code class="docutils literal notranslate"><span class="pre">a</span></code> to be instantiated to <code class="docutils literal notranslate"><span class="pre">5</span></code>, at which point, the second goal is solved automatically.</p>
<p>Sometimes, however, we want to synthesize the necessary arguments in the order that they appear. For that purpose there is a variant of <code class="docutils literal notranslate"><span class="pre">apply</span></code> called <code class="docutils literal notranslate"><span class="pre">fapply</span></code>:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%83%20a%20%3A%20%E2%84%95%2C%20a%20%3D%20a%20%3A%3D%0Abegin%0A%20%20fapply%20exists.intro%2C%0A%20%20exact%200%2C%0A%20%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">fapply</span><span class="w"> </span><span class="n">exists.intro</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span>
<span class="w">  </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here, the command <code class="docutils literal notranslate"><span class="pre">fapply</span> <span class="pre">exists.intro</span></code> leaves two goals. The first requires us to provide a natural number, <code class="docutils literal notranslate"><span class="pre">a</span></code>, and the second requires us to prove that <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">a</span></code>. The second goal depends on the first, so solving the first goal instantiates a metavariable in the second goal, which we then prove with <code class="docutils literal notranslate"><span class="pre">reflexivity</span></code>.</p>
<p>Another tactic that is sometimes useful is the <code class="docutils literal notranslate"><span class="pre">revert</span></code> tactic, which is, in a sense, an inverse to <code class="docutils literal notranslate"><span class="pre">intro</span></code>.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(x%20%3A%20%E2%84%95)%20%3A%20x%20%3D%20x%20%3A%3D%0Abegin%0A%20%20revert%20x%2C%0A%20%20--%20goal%20is%20%E2%8A%A2%20%E2%88%80%20(x%20%3A%20%E2%84%95)%2C%20x%20%3D%20x%0A%20%20intro%20y%2C%0A%20%20--%20goal%20is%20y%20%3A%20%E2%84%95%20%E2%8A%A2%20y%20%3D%20y%0A%20%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">revert</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is &#8866; &#8704; (x : &#8469;), x = x</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">y</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is y : &#8469; &#8866; y = y</span>
<span class="w">  </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Moving a hypothesis into the goal yields an implication:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(x%20y%20%3A%20%E2%84%95)%20(h%20%3A%20x%20%3D%20y)%20%3A%20y%20%3D%20x%20%3A%3D%0Abegin%0A%20%20revert%20h%2C%0A%20%20--%20goal%20is%20x%20y%20%3A%20%E2%84%95%20%E2%8A%A2%20x%20%3D%20y%20%E2%86%92%20y%20%3D%20x%0A%20%20intro%20h%E2%82%81%2C%0A%20%20--%20goal%20is%20x%20y%20%3A%20%E2%84%95%2C%20h%E2%82%81%20%3A%20x%20%3D%20y%20%E2%8A%A2%20y%20%3D%20x%0A%20%20symmetry%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">revert</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is x y : &#8469; &#8866; x = y &#8594; y = x</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h&#8321;</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is x y : &#8469;, h&#8321; : x = y &#8866; y = x</span>
<span class="w">  </span><span class="n">symmetry</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>But <code class="docutils literal notranslate"><span class="pre">revert</span></code> is even more clever, in that it will revert not only an element of the context but also all the subsequent elements of the context that depend on it. For example, reverting <code class="docutils literal notranslate"><span class="pre">x</span></code> in the example above brings <code class="docutils literal notranslate"><span class="pre">h</span></code> along with it:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(x%20y%20%3A%20%E2%84%95)%20(h%20%3A%20x%20%3D%20y)%20%3A%20y%20%3D%20x%20%3A%3D%0Abegin%0A%20%20revert%20x%2C%0A%20%20--%20goal%20is%20y%20%3A%20%E2%84%95%20%E2%8A%A2%20%E2%88%80%20(x%20%3A%20%E2%84%95)%2C%20x%20%3D%20y%20%E2%86%92%20y%20%3D%20x%0A%20%20intros%2C%0A%20%20symmetry%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">revert</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is y : &#8469; &#8866; &#8704; (x : &#8469;), x = y &#8594; y = x</span>
<span class="w">  </span><span class="n">intros</span><span class="o">,</span>
<span class="w">  </span><span class="n">symmetry</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>You can also revert multiple elements of the context at once:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(x%20y%20%3A%20%E2%84%95)%20(h%20%3A%20x%20%3D%20y)%20%3A%20y%20%3D%20x%20%3A%3D%0Abegin%0A%20%20revert%20x%20y%2C%0A%20%20--%20goal%20is%20%E2%8A%A2%20%E2%88%80%20(x%20y%20%3A%20%E2%84%95)%2C%20x%20%3D%20y%20%E2%86%92%20y%20%3D%20x%0A%20%20intros%2C%0A%20%20symmetry%2C%0A%20%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">revert</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is &#8866; &#8704; (x y : &#8469;), x = y &#8594; y = x</span>
<span class="w">  </span><span class="n">intros</span><span class="o">,</span>
<span class="w">  </span><span class="n">symmetry</span><span class="o">,</span>
<span class="w">  </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>You can only <code class="docutils literal notranslate"><span class="pre">revert</span></code> an element of the local context, that is, a local variable or hypothesis. But you can replace an arbitrary expression in the goal by a fresh variable using the <code class="docutils literal notranslate"><span class="pre">generalize</span></code> tactic.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%203%20%3D%203%20%3A%3D%0Abegin%0A%20%20generalize%20%3A%203%20%3D%20x%2C%0A%20%20--%20goal%20is%20x%20%3A%20%E2%84%95%20%E2%8A%A2%20x%20%3D%20x%2C%0A%20%20revert%20x%2C%0A%20%20--%20goal%20is%20%E2%8A%A2%20%E2%88%80%20(x%20%3A%20%E2%84%95)%2C%20x%20%3D%20x%0A%20%20intro%20y%2C%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">generalize</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is x : &#8469; &#8866; x = x,</span>
<span class="w">  </span><span class="n">revert</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is &#8866; &#8704; (x : &#8469;), x = x</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">y</span><span class="o">,</span><span class="w"> </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The mnemonic in the notation above is that you are generalizing the goal by setting <code class="docutils literal notranslate"><span class="pre">3</span></code> to an arbitrary variable <code class="docutils literal notranslate"><span class="pre">x</span></code>. Be careful: not every generalization preserves the validity of the goal. Here, <code class="docutils literal notranslate"><span class="pre">generalize</span></code> replaces a goal that could be proved using <code class="docutils literal notranslate"><span class="pre">reflexivity</span></code> with one that is not provable:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%202%20%2B%203%20%3D%205%20%3A%3D%0Abegin%0A%20%20generalize%20%3A%203%20%3D%20x%2C%0A%20%20--%20goal%20is%20x%20%3A%20%E2%84%95%20%E2%8A%A2%202%20%2B%20x%20%3D%205%2C%0A%20%20sorry%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">generalize</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is x : &#8469; &#8866; 2 + x = 5,</span>
<span class="w">  </span><span class="gr">sorry</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In this example, the <code class="docutils literal notranslate"><span class="pre">sorry</span></code> tactic is the analogue of the <code class="docutils literal notranslate"><span class="pre">sorry</span></code> proof term. It closes the current goal, producing the usual warning that <code class="docutils literal notranslate"><span class="pre">sorry</span></code> has been used. To preserve the validity of the previous goal, the <code class="docutils literal notranslate"><span class="pre">generalize</span></code> tactic allows us to record the fact that <code class="docutils literal notranslate"><span class="pre">3</span></code> has been replaced by <code class="docutils literal notranslate"><span class="pre">x</span></code>. All we need to do is to provide a label, and <code class="docutils literal notranslate"><span class="pre">generalize</span></code> uses it to store the assignment in the local context:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%202%20%2B%203%20%3D%205%20%3A%3D%0Abegin%0A%20%20generalize%20h%20%3A%203%20%3D%20x%2C%0A%20%20--%20goal%20is%20x%20%3A%20%E2%84%95%2C%20h%20%3A%203%20%3D%20x%20%E2%8A%A2%202%20%2B%20x%20%3D%205%2C%0A%20%20rw%20%E2%86%90h%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">generalize</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- goal is x : &#8469;, h : 3 = x &#8866; 2 + x = 5,</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="bp">&#8592;</span><span class="n">h</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here the <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic, abbreviated <code class="docutils literal notranslate"><span class="pre">rw</span></code>, uses <code class="docutils literal notranslate"><span class="pre">h</span></code> to replace <code class="docutils literal notranslate"><span class="pre">x</span></code> by <code class="docutils literal notranslate"><span class="pre">3</span></code> again. The <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic will be discussed below.</p>
</section>
<section id="more-tactics">
<h2><span class="section-number">5.3. </span>More Tactics<a class="headerlink" href="#more-tactics" title="Link to this heading">&#182;</a></h2>
<p>Some additional tactics are useful for constructing and destructing propositions and data. For example, when applied to a goal of the form <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&#8744;</span> <span class="pre">q</span></code>, the tactics <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code> are equivalent to <code class="docutils literal notranslate"><span class="pre">apply</span> <span class="pre">or.inl</span></code> and <code class="docutils literal notranslate"><span class="pre">apply</span> <span class="pre">or.inr</span></code>, respectively. Conversely, the <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic can be used to decompose a disjunction.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A8%20q%20%E2%86%92%20q%20%E2%88%A8%20p%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hq%2C%0A%20%20--%20case%20hp%20%3A%20p%0A%20%20right%2C%20exact%20hp%2C%0A%20%20--%20case%20hq%20%3A%20q%0A%20%20left%2C%20exact%20hq%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- case hp : p</span>
<span class="w">  </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="c1">-- case hq : q</span>
<span class="w">  </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hq</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>After <code class="docutils literal notranslate"><span class="pre">cases</span> <span class="pre">h</span></code> is applied, there are two goals. In the first, the hypothesis <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">:</span> <span class="pre">p</span> <span class="pre">&#8744;</span> <span class="pre">q</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">hp</span> <span class="pre">:</span> <span class="pre">p</span></code>, and in the second, it is replaced by <code class="docutils literal notranslate"><span class="pre">hq</span> <span class="pre">:</span> <span class="pre">q</span></code>. The <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic can also be used to decompose a conjunction.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20q%20%E2%86%92%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hq%2C%0A%20%20constructor%2C%20exact%20hq%2C%20exact%20hp%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In this example, there is only one goal after the <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic is applied, with <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">:</span> <span class="pre">p</span> <span class="pre">&#8743;</span> <span class="pre">q</span></code> replaced by a pair of assumptions, <code class="docutils literal notranslate"><span class="pre">hp</span> <span class="pre">:</span> <span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">hq</span> <span class="pre">:</span> <span class="pre">q</span></code>. The <code class="docutils literal notranslate"><span class="pre">constructor</span></code> tactic applies the unique constructor for conjunction, <code class="docutils literal notranslate"><span class="pre">and.intro</span></code>. With these tactics, an example from the previous section can be rewritten as follows:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20intro%20h%2C%0A%20%20%20cases%20h%20with%20hp%20hqr%2C%0A%20%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20%20left%2C%20constructor%2C%20repeat%20%7B%20assumption%20%7D%2C%0A%20%20%20%20%20right%2C%20constructor%2C%20repeat%20%7B%20assumption%20%7D%2C%0A%20%20intro%20h%2C%0A%20%20%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%20%20%20%20cases%20hpq%20with%20hp%20hq%2C%0A%20%20%20%20%20%20%20%20constructor%2C%20exact%20hp%2C%20left%2C%20exact%20hq%2C%0A%20%20%20%20%20%20cases%20hpr%20with%20hp%20hr%2C%0A%20%20%20%20%20%20%20%20constructor%2C%20exact%20hp%2C%20right%2C%20exact%20hr%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">   </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hqr</span><span class="o">,</span>
<span class="w">   </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">     </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">},</span>
<span class="w">     </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">      </span><span class="n">cases</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">        </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">      </span><span class="n">cases</span><span class="w"> </span><span class="n">hpr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">        </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hr</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>We will see in <a class="reference internal" href="inductive_types.html#inductive-types"><span class="std std-numref">Chapter 7</span></a> that these tactics are quite general. The <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic can be used to decompose any element of an inductively defined type; <code class="docutils literal notranslate"><span class="pre">constructor</span></code> always applies the first constructor of an inductively defined type, and <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code> can be used with inductively defined types with exactly <code class="docutils literal notranslate"><span class="pre">two</span></code> constructors. For example, we can use <code class="docutils literal notranslate"><span class="pre">cases</span></code> and <code class="docutils literal notranslate"><span class="pre">constructor</span></code> with an existential quantifier:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%20%3A%20(%E2%88%83%20x%2C%20p%20x)%20%E2%86%92%20%E2%88%83%20x%2C%20p%20x%20%E2%88%A8%20q%20x%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20x%20px%2C%0A%20%20constructor%2C%20left%2C%20exact%20px%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">px</span><span class="o">,</span>
<span class="w">  </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">px</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here, the <code class="docutils literal notranslate"><span class="pre">constructor</span></code> tactic leaves the first component of the existential assertion, the value of <code class="docutils literal notranslate"><span class="pre">x</span></code>, implicit. It is represented by a metavariable, which should be instantiated later on. In the previous example, the proper value of the metavariable is determined by the tactic <code class="docutils literal notranslate"><span class="pre">exact</span> <span class="pre">px</span></code>, since <code class="docutils literal notranslate"><span class="pre">px</span></code> has type <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">x</span></code>. If you want to specify a witness to the existential quantifier explicitly, you can use the <code class="docutils literal notranslate"><span class="pre">existsi</span></code> tactic instead:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%20%3A%20(%E2%88%83%20x%2C%20p%20x)%20%E2%86%92%20%E2%88%83%20x%2C%20p%20x%20%E2%88%A8%20q%20x%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20x%20px%2C%0A%20%20existsi%20x%2C%20left%2C%20exact%20px%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">px</span><span class="o">,</span>
<span class="w">  </span><span class="n">existsi</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">px</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here is another example:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%20%3A%0A%20%20(%E2%88%83%20x%2C%20p%20x%20%E2%88%A7%20q%20x)%20%E2%86%92%20%E2%88%83%20x%2C%20q%20x%20%E2%88%A7%20p%20x%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20x%20hpq%2C%0A%20%20cases%20hpq%20with%20hp%20hq%2C%0A%20%20existsi%20x%2C%0A%20%20split%3B%20assumption%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="o">(</span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="n">existsi</span><span class="w"> </span><span class="n">x</span><span class="o">,</span>
<span class="w">  </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here the semicolon after <code class="docutils literal notranslate"><span class="pre">split</span></code> tells Lean to apply the <code class="docutils literal notranslate"><span class="pre">assumption</span></code> tactic to both of the goals that are introduced by splitting the conjunction; see <a class="reference internal" href="#tactic-combinators"><span class="std std-numref">Section 5.5</span></a> for more information.</p>
<p>These tactics can be used on data just as well as propositions. In the next two examples, they are used to define functions which swap the components of the product and sum types:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=universes%20u%20v%0A%0Adef%20swap_pair%20%7B%CE%B1%20%3A%20Type%20u%7D%20%7B%CE%B2%20%3A%20Type%20v%7D%20%3A%20%CE%B1%20%C3%97%20%CE%B2%20%E2%86%92%20%CE%B2%20%C3%97%20%CE%B1%20%3A%3D%0Abegin%0A%20%20intro%20p%2C%0A%20%20cases%20p%20with%20ha%20hb%2C%0A%20%20constructor%2C%20exact%20hb%2C%20exact%20ha%0Aend%0A%0Adef%20swap_sum%20%7B%CE%B1%20%3A%20Type%20u%7D%20%7B%CE%B2%20%3A%20Type%20v%7D%20%3A%20%CE%B1%20%E2%8A%95%20%CE%B2%20%E2%86%92%20%CE%B2%20%E2%8A%95%20%CE%B1%20%3A%3D%0Abegin%0A%20%20intro%20p%2C%0A%20%20cases%20p%20with%20ha%20hb%2C%0A%20%20%20%20right%2C%20exact%20ha%2C%0A%20%20%20%20left%2C%20exact%20hb%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">universes</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="n">v</span>

<span class="kd">def</span><span class="w"> </span><span class="n">swap_pair</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">u</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">&#946;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">v</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="bp">&#215;</span><span class="w"> </span><span class="n">&#946;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#946;</span><span class="w"> </span><span class="bp">&#215;</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">p</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ha</span><span class="w"> </span><span class="n">hb</span><span class="o">,</span>
<span class="w">  </span><span class="n">constructor</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hb</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">ha</span>
<span class="kd">end</span>

<span class="kd">def</span><span class="w"> </span><span class="n">swap_sum</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">u</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">&#946;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">v</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="bp">&#8853;</span><span class="w"> </span><span class="n">&#946;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#946;</span><span class="w"> </span><span class="bp">&#8853;</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">p</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ha</span><span class="w"> </span><span class="n">hb</span><span class="o">,</span>
<span class="w">    </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">ha</span><span class="o">,</span>
<span class="w">    </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hb</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Note that up to the names we have chosen for the variables, the definitions are identical to the proofs of the analogous propositions for conjunction and disjunction. The <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic will also do a case distinction on a natural number:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=open%20nat%0A%0Aexample%20(P%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%20(h%E2%82%80%20%3A%20P%200)%20(h%E2%82%81%20%3A%20%E2%88%80%20n%2C%20P%20(succ%20n))%20(m%20%3A%20%E2%84%95)%20%3A%0A%20%20P%20m%20%3A%3D%0Abegin%0A%20%20cases%20m%20with%20m'%2C%20exact%20h%E2%82%80%2C%20exact%20h%E2%82%81%20m'%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">open</span><span class="w"> </span><span class="n">nat</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">P</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8320;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8704;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="o">))</span><span class="w"> </span><span class="o">(</span><span class="n">m</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">P</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">m&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h&#8320;</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h&#8321;</span><span class="w"> </span><span class="n">m&#39;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">cases</span></code> tactic, and its companion, the <code class="docutils literal notranslate"><span class="pre">induction</span></code> tactic, are discussed in greater detail in <a class="reference internal" href="inductive_types.html#tactics-for-inductive-types"><span class="std std-numref">Section 7.6</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">contradiction</span></code> tactic searches for a contradiction among the hypotheses of the current goal:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20%C2%AC%20p%20%E2%86%92%20q%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%20cases%20h%2C%20contradiction%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="bp">&#172;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">contradiction</span>
<span class="kd">end</span>
</pre></div>
</div>
</div></section>
<section id="structuring-tactic-proofs">
<span id="id2"></span><h2><span class="section-number">5.4. </span>Structuring Tactic Proofs<a class="headerlink" href="#structuring-tactic-proofs" title="Link to this heading">&#182;</a></h2>
<p>Tactics often provide an efficient way of building a proof, but long sequences of instructions can obscure the structure of the argument. In this section, we describe some means that help provide structure to a tactic-style proof, making such proofs more readable and robust.</p>
<p>One thing that is nice about Lean&#8217;s proof-writing syntax is that it is possible to mix term-style and tactic-style proofs, and pass between the two freely. For example, the tactics <code class="docutils literal notranslate"><span class="pre">apply</span></code> and <code class="docutils literal notranslate"><span class="pre">exact</span></code> expect arbitrary terms, which you can write using <code class="docutils literal notranslate"><span class="pre">have</span></code>, <code class="docutils literal notranslate"><span class="pre">show</span></code>, and so on. Conversely, when writing an arbitrary Lean term, you can always invoke the tactic mode by inserting a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block. The following is a somewhat toy example:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%92%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20exact%0A%20%20%20%20have%20hp%20%3A%20p%2C%20from%20h.left%2C%0A%20%20%20%20have%20hqr%20%3A%20q%20%E2%88%A8%20r%2C%20from%20h.right%2C%0A%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20begin%0A%20%20%20%20%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20%20%20%20%20exact%20or.inl%20%E2%9F%A8hp%2C%20hq%E2%9F%A9%2C%0A%20%20%20%20%20%20exact%20or.inr%20%E2%9F%A8hp%2C%20hr%E2%9F%A9%0A%20%20%20%20end%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">h.right</span><span class="o">,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">    </span><span class="kd">begin</span>
<span class="w">      </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;</span>
<span class="w">    </span><span class="kd">end</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The following is a more natural example:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%20%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20%20%20exact%20or.inl%20%E2%9F%A8h.left%2C%20hq%E2%9F%A9%2C%0A%20%20%20%20exact%20or.inr%20%E2%9F%A8h.left%2C%20hr%E2%9F%A9%2C%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%20%20exact%20%E2%9F%A8hpq.left%2C%20or.inl%20hpq.right%E2%9F%A9%2C%0A%20%20exact%20%E2%9F%A8hpr.left%2C%20or.inr%20hpr.right%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpq.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="n">hpq.right</span><span class="o">&#10217;,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpr.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="n">hpr.right</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In fact, there is a <code class="docutils literal notranslate"><span class="pre">show</span></code> tactic, which is the analog of the <code class="docutils literal notranslate"><span class="pre">show</span></code> keyword in a proof term. It simply declares the type of the goal that is about to be solved, while remaining in tactic mode. Moreover, in tactic mode, <code class="docutils literal notranslate"><span class="pre">from</span></code> is an alternative name for <code class="docutils literal notranslate"><span class="pre">exact</span></code>. With the <code class="docutils literal notranslate"><span class="pre">show</span></code> and <code class="docutils literal notranslate"><span class="pre">from</span></code> tactics, the previous proof can be written more perspicuously as follows:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%20%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20from%20or.inl%20%E2%9F%A8h.left%2C%20hq%E2%9F%A9%2C%0A%20%20%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20from%20or.inr%20%E2%9F%A8h.left%2C%20hr%E2%9F%A9%2C%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20from%20%E2%9F%A8hpq.left%2C%20or.inl%20hpq.right%E2%9F%A9%2C%0A%20%20%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20from%20%E2%9F%A8hpr.left%2C%20or.inr%20hpr.right%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">      </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;,</span>
<span class="w">      </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpq.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="n">hpq.right</span><span class="o">&#10217;,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpr.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="n">hpr.right</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Alternatively, you can leave off the <code class="docutils literal notranslate"><span class="pre">from</span></code> and remain in tactic mode:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%20%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20%7B%20left%2C%20split%2C%20exact%20h.left%2C%20assumption%20%7D%2C%0A%20%20%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20%7B%20right%2C%20split%2C%20exact%20h.left%2C%20assumption%20%7D%2C%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20%7B%20cases%20hpq%2C%20split%2C%20assumption%2C%20left%2C%20assumption%20%7D%2C%0A%20%20%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20%7B%20cases%20hpr%2C%20split%2C%20assumption%2C%20right%2C%20assumption%20%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">      </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="o">{</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">split</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">},</span>
<span class="w">      </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="o">{</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">split</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="o">{</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span><span class="w"> </span><span class="n">split</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">},</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="o">{</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span><span class="w"> </span><span class="n">split</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The <code class="docutils literal notranslate"><span class="pre">show</span></code> tactic can actually be used to rewrite a goal to something definitionally equivalent:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(n%20%3A%20%E2%84%95)%20%3A%20n%20%2B%201%20%3D%20nat.succ%20n%20%3A%3D%0Abegin%0A%20%20show%20nat.succ%20n%20%3D%20nat.succ%20n%2C%0A%20%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">nat.succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">nat.succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">nat.succ</span><span class="w"> </span><span class="n">n</span><span class="o">,</span>
<span class="w">  </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In fact, <code class="docutils literal notranslate"><span class="pre">show</span></code> does a little more work. When there are multiple goals, you can use <code class="docutils literal notranslate"><span class="pre">show</span></code> to select which goal you want to work on. Thus both proofs below work:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20q%20%E2%86%92%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hq%2C%0A%20%20split%2C%0A%20%20show%20q%2C%20from%20hq%2C%0A%20%20show%20p%2C%20from%20hp%0Aend%0A%0Aexample%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20q%20%E2%86%92%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hq%2C%0A%20%20split%2C%0A%20%20show%20p%2C%20from%20hp%2C%0A%20%20show%20q%2C%20from%20hq%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="n">split</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">q</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">hp</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">  </span><span class="n">split</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">hp</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">q</span><span class="o">,</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">hq</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>There is also a <code class="docutils literal notranslate"><span class="pre">have</span></code> tactic, which introduces a new subgoal, just as when writing proof terms:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%92%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hqr%2C%0A%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20have%20hpq%20%3A%20p%20%E2%88%A7%20q%2C%0A%20%20%20%20%20%20from%20and.intro%20hp%20hq%2C%0A%20%20%20%20left%2C%20exact%20hpq%2C%0A%20%20have%20hpr%20%3A%20p%20%E2%88%A7%20r%2C%0A%20%20%20%20from%20and.intro%20hp%20hr%2C%0A%20%20right%2C%20exact%20hpr%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hqr</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">,</span>
<span class="w">      </span><span class="k">from</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hq</span><span class="o">,</span>
<span class="w">    </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hpr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">,</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">and.intro</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">  </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hpr</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>As with <code class="docutils literal notranslate"><span class="pre">show</span></code>, you can omit the <code class="docutils literal notranslate"><span class="pre">from</span></code> and stay in tactic mode:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%92%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hqr%2C%0A%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20have%20hpq%20%3A%20p%20%E2%88%A7%20q%2C%0A%20%20%20%20%20%20split%3B%20assumption%2C%0A%20%20%20%20left%2C%20exact%20hpq%2C%0A%20%20have%20hpr%20%3A%20p%20%E2%88%A7%20r%2C%0A%20%20%20%20split%3B%20assumption%2C%0A%20%20right%2C%20exact%20hpr%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hqr</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">,</span>
<span class="w">      </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">    </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hpq</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hpr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">,</span>
<span class="w">    </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">  </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hpr</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>As with proof terms, you can omit the label in the <code class="docutils literal notranslate"><span class="pre">have</span></code> tactic, in which case, the default label <code class="docutils literal notranslate"><span class="pre">this</span></code> is used:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%92%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hp%20hqr%2C%0A%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20have%20%3A%20p%20%E2%88%A7%20q%2C%0A%20%20%20%20%20%20split%3B%20assumption%2C%0A%20%20%20%20left%2C%20exact%20this%2C%0A%20%20have%20%3A%20p%20%E2%88%A7%20r%2C%0A%20%20%20%20split%3B%20assumption%2C%0A%20%20right%2C%20exact%20this%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="n">hqr</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">,</span>
<span class="w">      </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">    </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">this</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">,</span>
<span class="w">    </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span><span class="o">,</span>
<span class="w">  </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">this</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>You can also use the <code class="docutils literal notranslate"><span class="pre">have</span></code> tactic with the <code class="docutils literal notranslate"><span class="pre">:=</span></code> token, which has the same effect as <code class="docutils literal notranslate"><span class="pre">from</span></code>:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%92%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20intro%20h%2C%0A%20%20have%20hp%20%3A%20p%20%3A%3D%20h.left%2C%0A%20%20have%20hqr%20%3A%20q%20%E2%88%A8%20r%20%3A%3D%20h.right%2C%0A%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20cases%20hqr%20with%20hq%20hr%2C%0A%20%20%20%20exact%20or.inl%20%E2%9F%A8hp%2C%20hq%E2%9F%A9%2C%0A%20%20exact%20or.inr%20%E2%9F%A8hp%2C%20hr%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.right</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">hqr</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In this case, the types can be omitted, so we can write <code class="docutils literal notranslate"><span class="pre">have</span> <span class="pre">hp</span> <span class="pre">:=</span> <span class="pre">h.left</span></code> and <code class="docutils literal notranslate"><span class="pre">have</span> <span class="pre">hqr</span> <span class="pre">:=</span> <span class="pre">h.right</span></code>. In fact, with this notation, you can even omit both the type and the label, in which case the new fact is introduced with the label <code class="docutils literal notranslate"><span class="pre">this</span></code>.</p>
<p>Lean also has a <code class="docutils literal notranslate"><span class="pre">let</span></code> tactic, which is similar to the <code class="docutils literal notranslate"><span class="pre">have</span></code> tactic, but is used to introduce local definitions instead of auxiliary facts. It is the tactic analogue of a <code class="docutils literal notranslate"><span class="pre">let</span></code> in a proof term.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20%3A%20%E2%88%83%20x%2C%20x%20%2B%202%20%3D%208%20%3A%3D%0Abegin%0A%20%20let%20a%20%3A%20%E2%84%95%20%3A%3D%203%20*%202%2C%0A%20%20existsi%20a%2C%0A%20%20reflexivity%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">&#8707;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span>
<span class="w">  </span><span class="n">existsi</span><span class="w"> </span><span class="n">a</span><span class="o">,</span>
<span class="w">  </span><span class="n">reflexivity</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>As with <code class="docutils literal notranslate"><span class="pre">have</span></code>, you can leave the type implicit by writing <code class="docutils literal notranslate"><span class="pre">let</span> <span class="pre">a</span> <span class="pre">:=</span> <span class="pre">3</span> <span class="pre">*</span> <span class="pre">2</span></code>. The difference between <code class="docutils literal notranslate"><span class="pre">let</span></code> and <code class="docutils literal notranslate"><span class="pre">have</span></code> is that <code class="docutils literal notranslate"><span class="pre">let</span></code> introduces a local definition in the context, so that the definition of the local constant can be unfolded in the proof.</p>
<p>For even more structured proofs, you can nest <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> blocks within other <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> blocks. In a nested block, Lean focuses on the first goal, and generates an error if it has not been fully solved at the end of the block. This can be helpful in indicating the separate proofs of multiple subgoals introduced by a tactic.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20begin%0A%20%20%20%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20begin%0A%20%20%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20or.inl%20%E2%9F%A8h.left%2C%20hq%E2%9F%A9%0A%20%20%20%20end%2C%0A%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20exact%20or.inr%20%E2%9F%A8h.left%2C%20hr%E2%9F%A9%0A%20%20end%2C%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20begin%0A%20%20%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20exact%20%E2%9F%A8hpq.left%2C%20or.inl%20hpq.right%E2%9F%A9%0A%20%20end%2C%0A%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20exact%20%E2%9F%A8hpr.left%2C%20or.inr%20hpr.right%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">  </span><span class="kd">begin</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="kd">begin</span>
<span class="w">      </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;</span>
<span class="w">    </span><span class="kd">end</span><span class="o">,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;</span>
<span class="w">  </span><span class="kd">end</span><span class="o">,</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">  </span><span class="kd">begin</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpq.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="n">hpq.right</span><span class="o">&#10217;</span>
<span class="w">  </span><span class="kd">end</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpr.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="n">hpr.right</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Here, we have introduced a new <code class="docutils literal notranslate"><span class="pre">begin..end</span></code> block whenever a tactic leaves more than one subgoal. You can check that at every line in this proof, there is only one goal visible. Notice that you still need to use a comma after a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block when there are remaining goals to be discharged.</p>
<p>Within a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block, you can abbreviate nested occurrences of <code class="docutils literal notranslate"><span class="pre">begin</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> with curly braces:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%7B%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20%7B%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20or.inl%20%E2%9F%A8h.left%2C%20hq%E2%9F%A9%20%7D%2C%0A%20%20%20%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20exact%20or.inr%20%E2%9F%A8h.left%2C%20hr%E2%9F%A9%20%7D%2C%0A%20%20intro%20h%2C%0A%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%7B%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20exact%20%E2%9F%A8hpq.left%2C%20or.inl%20hpq.right%E2%9F%A9%20%7D%2C%0A%20%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20exact%20%E2%9F%A8hpr.left%2C%20or.inr%20hpr.right%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpq.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="n">hpq.right</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpr.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="n">hpr.right</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>This helps explain the convention on indentation we have adopted here: every time a tactic leaves more than one subgoal, we separate the remaining subgoals by enclosing them in blocks and indenting, until we are back down to one subgoal. Thus if the application of theorem <code class="docutils literal notranslate"><span class="pre">foo</span></code> to a single goal produces four subgoals, one would expect the proof to look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>begin
  apply foo,
  { ... proof of first goal ... },
  { ... proof of second goal ... },
  { ... proof of third goal ... },
  proof of final goal
end
</pre></div>
</div>
<p>Another reasonable convention is to enclose <em>all</em> the remaining subgoals in indented blocks, including the last one:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%E2%86%94%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%7B%20intro%20h%2C%0A%20%20%20%20cases%20h.right%20with%20hq%20hr%2C%0A%20%20%20%20%7B%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20or.inl%20%E2%9F%A8h.left%2C%20hq%E2%9F%A9%20%7D%2C%0A%20%20%20%20%7B%20show%20(p%20%E2%88%A7%20q)%20%E2%88%A8%20(p%20%E2%88%A7%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20or.inr%20%E2%9F%A8h.left%2C%20hr%E2%9F%A9%20%7D%7D%2C%0A%20%20%7B%20intro%20h%2C%0A%20%20%20%20cases%20h%20with%20hpq%20hpr%2C%0A%20%20%20%20%7B%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20%E2%9F%A8hpq.left%2C%20or.inl%20hpq.right%E2%9F%A9%20%7D%2C%0A%20%20%20%20%7B%20show%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%2C%0A%20%20%20%20%20%20%20%20exact%20%E2%9F%A8hpr.left%2C%20or.inr%20hpr.right%E2%9F%A9%20%7D%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h.right</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="n">hr</span><span class="o">,</span>
<span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">h.left</span><span class="o">,</span><span class="w"> </span><span class="n">hr</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">}},</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="n">cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">hpq</span><span class="w"> </span><span class="n">hpr</span><span class="o">,</span>
<span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpq.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inl</span><span class="w"> </span><span class="n">hpq.right</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">    </span><span class="o">{</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">),</span>
<span class="w">        </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hpr.left</span><span class="o">,</span><span class="w"> </span><span class="n">or.inr</span><span class="w"> </span><span class="n">hpr.right</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">}}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>With this convention, the proof using <code class="docutils literal notranslate"><span class="pre">foo</span></code> described above would look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>begin
  apply foo,
  { ... proof of first goal ... },
  { ... proof of second goal ... },
  { ... proof of third goal ... },
  { ... proof of final goal ....}
end
</pre></div>
</div>
<p>Both conventions are reasonable. The second convention has the effect that the text in a long proof gradually creeps to the right. Many theorems in mathematics have side conditions that can be dispelled quickly; using the first convention means that the proofs of these side conditions are indented until we return to the &#8220;linear&#8221; part of the proof.</p>
<p>Combining these various mechanisms makes for nicely structured tactic proofs:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20%3A%20p%20%E2%88%A7%20q%20%E2%86%94%20q%20%E2%88%A7%20p%20%3A%3D%0Abegin%0A%20%20apply%20iff.intro%2C%0A%20%20%7B%20intro%20h%2C%0A%20%20%20%20have%20hp%20%3A%20p%20%3A%3D%20h.left%2C%0A%20%20%20%20have%20hq%20%3A%20q%20%3A%3D%20h.right%2C%0A%20%20%20%20show%20q%20%E2%88%A7%20p%2C%0A%20%20%20%20%20%20exact%20%E2%9F%A8hq%2C%20hp%E2%9F%A9%20%7D%2C%0A%20%20intro%20h%2C%0A%20%20have%20hp%20%3A%20p%20%3A%3D%20h.right%2C%0A%20%20have%20hq%20%3A%20q%20%3A%3D%20h.left%2C%0A%20%20show%20p%20%E2%88%A7%20q%2C%0A%20%20%20%20exact%20%E2%9F%A8hp%2C%20hq%E2%9F%A9%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">iff.intro</span><span class="o">,</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.right</span><span class="o">,</span>
<span class="w">    </span><span class="k">show</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="o">,</span>
<span class="w">      </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hq</span><span class="o">,</span><span class="w"> </span><span class="n">hp</span><span class="o">&#10217;</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">intro</span><span class="w"> </span><span class="n">h</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.right</span><span class="o">,</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h.left</span><span class="o">,</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">,</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="o">&#10216;</span><span class="n">hp</span><span class="o">,</span><span class="w"> </span><span class="n">hq</span><span class="o">&#10217;</span>
<span class="kd">end</span>
</pre></div>
</div>
</div></section>
<section id="tactic-combinators">
<span id="id3"></span><h2><span class="section-number">5.5. </span>Tactic Combinators<a class="headerlink" href="#tactic-combinators" title="Link to this heading">&#182;</a></h2>
<p><em>Tactic combinators</em> are operations that form new tactics from old ones. A sequencing combinator is already implicit in the commas that appear in a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%3A%3D%0Abegin%20left%2C%20assumption%20end" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="kd">end</span>
</pre></div>
</div>
</div><p>This is essentially equivalent to the following:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%3A%3D%0Aby%20%7B%20left%2C%20assumption%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>Here, <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">left,</span> <span class="pre">assumption</span> <span class="pre">}</span></code> is functionally equivalent to a single tactic which first applies <code class="docutils literal notranslate"><span class="pre">left</span></code> and then applies <code class="docutils literal notranslate"><span class="pre">assumption</span></code>.</p>
<p>In an expression <code class="docutils literal notranslate"><span class="pre">t&#8321;;</span> <span class="pre">t&#8322;</span></code>, the semicolon provides a <em>parallel</em> version of the sequencing operation: <code class="docutils literal notranslate"><span class="pre">t&#8321;</span></code> is applied to the current goal, and then <code class="docutils literal notranslate"><span class="pre">t&#8322;</span></code> is applied to <em>all</em> the resulting subgoals:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20q%20%3A%3D%0Aby%20split%3B%20assumption" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>This is especially useful when the resulting goals can be finished off in a uniform way, or, at least, when it is possible to make progress on all of them uniformly.</p>
<p>The <em>orelse</em> combinator, denoted <code class="docutils literal notranslate"><span class="pre">&lt;|&gt;</span></code>, applies one tactic, and then backtracks and applies another one if the first one fails:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%3A%3D%0Aby%20%7B%20left%2C%20assumption%20%7D%20%3C%7C%3E%20%7B%20right%2C%20assumption%7D%0A%0Aexample%20(p%20q%20%3A%20Prop)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A8%20q%20%3A%3D%0Aby%20%7B%20left%2C%20assumption%20%7D%20%3C%7C%3E%20%7B%20right%2C%20assumption%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span>
</pre></div>
</div>
</div><p>In the first example, the left branch succeeds, whereas in the second one, it is the right one that succeeds. In the next three examples, the same compound tactic succeeds in each case.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20repeat%20%7B%20%7Bleft%2C%20assumption%7D%20%3C%7C%3E%20right%20%3C%7C%3E%20assumption%20%7D%0A%0Aexample%20(p%20q%20r%20%3A%20Prop)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20repeat%20%7B%20%7Bleft%2C%20assumption%7D%20%3C%7C%3E%20right%20%3C%7C%3E%20assumption%20%7D%0A%0Aexample%20(p%20q%20r%20%3A%20Prop)%20(hr%20%3A%20r)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20repeat%20%7B%20%7Bleft%2C%20assumption%7D%20%3C%7C%3E%20right%20%3C%7C%3E%20assumption%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">{</span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">{</span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">{</span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>The tactic tries to solve the left disjunct immediately by assumption; if that fails, it tries to focus on the right disjunct; and if that doesn&#8217;t work, it invokes the assumption tactic.</p>
<p>Incidentally, a tactic expression is really a formal term in Lean, of type <code class="docutils literal notranslate"><span class="pre">tactic</span> <span class="pre">&#945;</span></code> for some <code class="docutils literal notranslate"><span class="pre">&#945;</span></code>. Tactics can be defined and then applied later on.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=meta%20def%20my_tac%20%3A%20tactic%20unit%20%3A%3D%0A%60%5B%20repeat%20%7B%20%7Bleft%2C%20assumption%7D%20%3C%7C%3E%20right%20%3C%7C%3E%20assumption%20%7D%20%5D%0A%0Aexample%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20my_tac%0A%0Aexample%20(p%20q%20r%20%3A%20Prop)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20my_tac%0A%0Aexample%20(p%20q%20r%20%3A%20Prop)%20(hr%20%3A%20r)%20%3A%20p%20%E2%88%A8%20q%20%E2%88%A8%20r%20%3A%3D%0Aby%20my_tac" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">meta</span><span class="w"> </span><span class="kd">def</span><span class="w"> </span><span class="n">my_tac</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">tactic</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">{</span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="o">]</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">my_tac</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">my_tac</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">my_tac</span>
</pre></div>
</div>
</div><p>With a <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block or after a <code class="docutils literal notranslate"><span class="pre">by</span></code>, Lean&#8217;s parser uses special mechanisms to parse these expressions, but they are similar to ordinary expressions in Lean like <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">&#945;</span></code>. (The annotation <code class="docutils literal notranslate"><span class="pre">[...]</span></code> in the definition of <code class="docutils literal notranslate"><span class="pre">my_tac</span></code> above invokes the special parsing mechanism here, too.) The book <a class="reference external" href="https://leanprover.github.io/programming_in_lean/">Programming in Lean</a> provides a fuller introduction to writing tactics and installing them for interactive use. The tactic combinators we are discussing here serve as casual entry points to the tactic programming language.</p>
<p>You will have no doubt noticed by now that tactics can fail. Indeed, it is the &#8220;failure&#8221; state that causes the <em>orelse</em> combinator to backtrack and try the next tactic. The <code class="docutils literal notranslate"><span class="pre">try</span></code> combinator builds a tactic that always succeeds, though possibly in a trivial way: <code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">t</span></code> executes <code class="docutils literal notranslate"><span class="pre">t</span></code> and reports success, even if <code class="docutils literal notranslate"><span class="pre">t</span></code> fails. It is equivalent to <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">&lt;|&gt;</span> <span class="pre">skip</span></code>, where <code class="docutils literal notranslate"><span class="pre">skip</span></code> is a tactic that does nothing (and succeeds in doing so). In the next example, the second <code class="docutils literal notranslate"><span class="pre">split</span></code> succeeds on the right conjunct <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">&#8743;</span> <span class="pre">r</span></code> (remember that disjunction and conjunction associate to the right) but fails on the first. The <code class="docutils literal notranslate"><span class="pre">try</span></code> tactic ensures that the sequential composition succeeds.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20(hr%20%3A%20r)%20%3A%0A%20%20p%20%E2%88%A7%20q%20%E2%88%A7%20r%20%3A%3D%0Aby%20split%3B%20try%20%7Bsplit%7D%3B%20assumption" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="o">{</span><span class="n">split</span><span class="o">}</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>Be careful: <code class="docutils literal notranslate"><span class="pre">repeat</span> <span class="pre">{try</span> <span class="pre">t}</span></code> will loop forever, because the inner tactic never fails.</p>
<p>In a proof, there are often multiple goals outstanding. Parallel sequencing is one way to arrange it so that a single tactic is applied to multiple goals, but there are other ways to do this. For example, <code class="docutils literal notranslate"><span class="pre">all_goals</span> <span class="pre">t</span></code> applies <code class="docutils literal notranslate"><span class="pre">t</span></code> to all open goals:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20(hr%20%3A%20r)%20%3A%0A%20%20p%20%E2%88%A7%20q%20%E2%88%A7%20r%20%3A%3D%0Abegin%0A%20%20split%2C%0A%20%20all_goals%20%7B%20try%20%7Bsplit%7D%20%7D%2C%0A%20%20all_goals%20%7B%20assumption%20%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">split</span><span class="o">,</span>
<span class="w">  </span><span class="n">all_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="o">{</span><span class="n">split</span><span class="o">}</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">all_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In this case, the <code class="docutils literal notranslate"><span class="pre">any_goals</span></code> tactic provides a more robust solution.
It is similar to <code class="docutils literal notranslate"><span class="pre">all_goals</span></code>, except it fails unless its argument
succeeds on at least one goal.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20(hr%20%3A%20r)%20%3A%0A%20%20p%20%E2%88%A7%20q%20%E2%88%A7%20r%20%3A%3D%0Abegin%0A%20%20split%2C%0A%20%20any_goals%20%7B%20split%20%7D%2C%0A%20%20any_goals%20%7B%20assumption%20%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">split</span><span class="o">,</span>
<span class="w">  </span><span class="n">any_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">},</span>
<span class="w">  </span><span class="n">any_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>The first tactic in the <code class="docutils literal notranslate"><span class="pre">begin...end</span></code> block below repeatedly splits
conjunctions:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20(hr%20%3A%20r)%20%3A%0A%20%20p%20%E2%88%A7%20((p%20%E2%88%A7%20q)%20%E2%88%A7%20r)%20%E2%88%A7%20(q%20%E2%88%A7%20r%20%E2%88%A7%20p)%20%3A%3D%0Abegin%0A%20%20repeat%20%7B%20any_goals%20%7B%20split%20%7D%7D%2C%0A%20%20all_goals%20%7B%20assumption%20%7D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">((</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">any_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">}},</span>
<span class="w">  </span><span class="n">all_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In fact, we can compress the full tactic down to one line:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20(hr%20%3A%20r)%20%3A%0A%20%20p%20%E2%88%A7%20((p%20%E2%88%A7%20q)%20%E2%88%A7%20r)%20%E2%88%A7%20(q%20%E2%88%A7%20r%20%E2%88%A7%20p)%20%3A%3D%0Aby%20repeat%20%7B%20any_goals%20%7B%20split%20%3C%7C%3E%20assumption%7D%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">((</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">any_goals</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="bp">&lt;|&gt;</span><span class="w"> </span><span class="n">assumption</span><span class="o">}</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>The combinators <code class="docutils literal notranslate"><span class="pre">focus</span></code> and <code class="docutils literal notranslate"><span class="pre">solve1</span></code> go in the other direction. Specifically, <code class="docutils literal notranslate"><span class="pre">focus</span> <span class="pre">t</span></code> ensures that <code class="docutils literal notranslate"><span class="pre">t</span></code> only effects the current goal, temporarily hiding the others from the scope. So, if <code class="docutils literal notranslate"><span class="pre">t</span></code> ordinarily only effects the current goal, <code class="docutils literal notranslate"><span class="pre">focus</span> <span class="pre">{</span> <span class="pre">all_goals</span> <span class="pre">{t}</span> <span class="pre">}</span></code> has the same effect as <code class="docutils literal notranslate"><span class="pre">t</span></code>. The tactic <code class="docutils literal notranslate"><span class="pre">solve1</span> <span class="pre">t</span></code> is similar, except that it fails unless <code class="docutils literal notranslate"><span class="pre">t</span></code> succeeds in solving the goal entirely. The <code class="docutils literal notranslate"><span class="pre">done</span></code> tactic is also sometimes useful to direct the flow of control; it succeeds only if there are no goals left to be solved.</p>
</section>
<section id="rewriting">
<h2><span class="section-number">5.6. </span>Rewriting<a class="headerlink" href="#rewriting" title="Link to this heading">&#182;</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic (abbreviated <code class="docutils literal notranslate"><span class="pre">rw</span></code>) and the <code class="docutils literal notranslate"><span class="pre">simp</span></code> tactic were introduced briefly in <a class="reference internal" href="quantifiers_and_equality.html#calculational-proofs"><span class="std std-numref">Section 4.3</span></a>. In this section and the next, we discuss them in greater detail.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic provides a basic mechanism for applying substitutions to goals and hypotheses, providing a convenient and efficient way of working with equality. The most basic form of the tactic is <code class="docutils literal notranslate"><span class="pre">rewrite</span> <span class="pre">t</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is a term whose type asserts an equality. For example, <code class="docutils literal notranslate"><span class="pre">t</span></code> can be a hypothesis <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">:</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code> in the context; it can be a general lemma, like <code class="docutils literal notranslate"><span class="pre">add_comm</span> <span class="pre">:</span> <span class="pre">&#8704;</span> <span class="pre">x</span> <span class="pre">y,</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">+</span> <span class="pre">x</span></code>, in which the rewrite tactic tries to find suitable instantiations of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>; or it can be any compound term asserting a concrete or general equation. In the following example, we use this basic form to rewrite the goal using a hypothesis.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(k%20%3A%20%E2%84%95)%0A%0Aexample%20(h%E2%82%81%20%3A%20f%200%20%3D%200)%20(h%E2%82%82%20%3A%20k%20%3D%200)%20%3A%20f%20k%20%3D%200%20%3A%3D%0Abegin%0A%20%20rw%20h%E2%82%82%2C%20--%20replace%20k%20with%200%0A%20%20rw%20h%E2%82%81%20%20--%20replace%20f%200%20with%200%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">,</span><span class="w"> </span><span class="c1">-- replace k with 0</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="n">h&#8321;</span><span class="w">  </span><span class="c1">-- replace f 0 with 0</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In the example above, the first use of <code class="docutils literal notranslate"><span class="pre">rw</span></code> replaces <code class="docutils literal notranslate"><span class="pre">k</span></code> with <code class="docutils literal notranslate"><span class="pre">0</span></code> in the goal <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">k</span> <span class="pre">=</span> <span class="pre">0</span></code>. Then, the second one replaces <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">0</span></code> with <code class="docutils literal notranslate"><span class="pre">0</span></code>. The tactic automatically closes any goal of the form <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">t</span></code>. Here is an example of rewriting using a compound expression:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(x%20y%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%20(q%20%3A%20Prop)%20(h%20%3A%20q%20%E2%86%92%20x%20%3D%20y)%0A%20%20(h'%20%3A%20p%20y)%20(hq%20%3A%20q)%20%3A%20p%20x%20%3A%3D%0Aby%20%7B%20rw%20(h%20hq)%2C%20assumption%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="o">)</span>
<span class="w">  </span><span class="o">(</span><span class="n">h&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="n">hq</span><span class="o">),</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>Here, <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">hq</span></code> establishes the equation <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code>. The parentheses around <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">hq</span></code> are not necessary, but we have added them for clarity.</p>
<p>Multiple rewrites can be combined using the notation <code class="docutils literal notranslate"><span class="pre">rw</span> <span class="pre">[t_1,</span> <span class="pre">...,</span> <span class="pre">t_n]</span></code>, which is just shorthand for <code class="docutils literal notranslate"><span class="pre">rewrite</span> <span class="pre">t_1,</span> <span class="pre">...,</span> <span class="pre">rewrite</span> <span class="pre">t_n</span></code>. The previous example can be written as follows:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(k%20%3A%20%E2%84%95)%0A%0Aexample%20(h%E2%82%81%20%3A%20f%200%20%3D%200)%20(h%E2%82%82%20%3A%20k%20%3D%200)%20%3A%20f%20k%20%3D%200%20%3A%3D%0Aby%20rw%20%5Bh%E2%82%82%2C%20h%E2%82%81%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">h&#8322;</span><span class="o">,</span><span class="w"> </span><span class="n">h&#8321;</span><span class="o">]</span>
</pre></div>
</div>
</div><p>By default, <code class="docutils literal notranslate"><span class="pre">rw</span></code> uses an equation in the forward direction, matching the left-hand side with an expression, and replacing it with the right-hand side. The notation <code class="docutils literal notranslate"><span class="pre">&#8592;t</span></code> can be used to instruct the tactic to use the equality <code class="docutils literal notranslate"><span class="pre">t</span></code> in the reverse direction.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(a%20b%20%3A%20%E2%84%95)%0A%0Aexample%20(h%E2%82%81%20%3A%20a%20%3D%20b)%20(h%E2%82%82%20%3A%20f%20a%20%3D%200)%20%3A%20f%20b%20%3D%200%20%3A%3D%0Abegin%0A%20%20rw%20%5B%E2%86%90h%E2%82%81%2C%20h%E2%82%82%5D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="bp">&#8592;</span><span class="n">h&#8321;</span><span class="o">,</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">]</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In this example, the term <code class="docutils literal notranslate"><span class="pre">&#8592;h&#8321;</span></code> instructs the rewriter to replace <code class="docutils literal notranslate"><span class="pre">b</span></code> with <code class="docutils literal notranslate"><span class="pre">a</span></code>. In the editors, you can type the backwards arrow as <code class="docutils literal notranslate"><span class="pre">\l</span></code>. You can also use the ascii equivalent, <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code>.</p>
<p>Sometimes the left-hand side of an identity can match more than one subterm in the pattern, in which case the <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic chooses the first match it finds when traversing the term. If that is not the one you want, you can use additional arguments to specify the appropriate subterm.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0Aexample%20(a%20b%20c%20%3A%20%E2%84%95)%20%3A%20a%20%2B%20b%20%2B%20c%20%3D%20a%20%2B%20c%20%2B%20b%20%3A%3D%0Abegin%0A%20%20rw%20%5Badd_assoc%2C%20add_comm%20b%2C%20%E2%86%90add_assoc%5D%0Aend%0A%0Aexample%20(a%20b%20c%20%3A%20%E2%84%95)%20%3A%20a%20%2B%20b%20%2B%20c%20%3D%20a%20%2B%20c%20%2B%20b%20%3A%3D%0Abegin%0A%20%20rw%20%5Badd_assoc%2C%20add_assoc%2C%20add_comm%20b%5D%0Aend%0A%0Aexample%20(a%20b%20c%20%3A%20%E2%84%95)%20%3A%20a%20%2B%20b%20%2B%20c%20%3D%20a%20%2B%20c%20%2B%20b%20%3A%3D%0Abegin%0A%20%20rw%20%5Badd_assoc%2C%20add_assoc%2C%20add_comm%20_%20b%5D%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.nat.basic</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_comm</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="bp">&#8592;</span><span class="n">add_assoc</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_comm</span><span class="w"> </span><span class="n">b</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_comm</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">b</span><span class="o">]</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>In the first example above, the first step rewrites <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">c</span></code> to <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">(b</span> <span class="pre">+</span> <span class="pre">c)</span></code>. Then next applies commutativity to the term <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">+</span> <span class="pre">c</span></code>; without specifying the argument, the tactic would instead rewrite <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">(b</span> <span class="pre">+</span> <span class="pre">c)</span></code> to <code class="docutils literal notranslate"><span class="pre">(b</span> <span class="pre">+</span> <span class="pre">c)</span> <span class="pre">+</span> <span class="pre">a</span></code>. Finally, the last step applies associativity in the reverse direction rewriting <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">(c</span> <span class="pre">+</span> <span class="pre">b)</span></code> to <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">c</span> <span class="pre">+</span> <span class="pre">b</span></code>. The next two examples instead apply associativity to move the parenthesis to the right on both sides, and then switch <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>. Notice that the last example specifies that the rewrite should take place on the right-hand side by specifying the second argument to <code class="docutils literal notranslate"><span class="pre">add_comm</span></code>.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic affects only the goal. The notation <code class="docutils literal notranslate"><span class="pre">rw</span> <span class="pre">t</span> <span class="pre">at</span> <span class="pre">h</span></code> applies the rewrite <code class="docutils literal notranslate"><span class="pre">t</span></code> at hypothesis <code class="docutils literal notranslate"><span class="pre">h</span></code>.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0A--%20BEGIN%0Avariables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(a%20%3A%20%E2%84%95)%0A%0Aexample%20(h%20%3A%20a%20%2B%200%20%3D%200)%20%3A%20f%20a%20%3D%20f%200%20%3A%3D%0Aby%20%7B%20rw%20add_zero%20at%20h%2C%20rw%20h%20%7D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="n">add_zero</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>The first step, <code class="docutils literal notranslate"><span class="pre">rw</span> <span class="pre">add_zero</span> <span class="pre">at</span> <span class="pre">h</span></code>, rewrites the hypothesis <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">0</span></code>. Then the new hypothesis <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">0</span></code> is used to rewrite the goal to <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">f</span> <span class="pre">0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> tactic is not restricted to propositions. In the following example, we use <code class="docutils literal notranslate"><span class="pre">rw</span> <span class="pre">h</span> <span class="pre">at</span> <span class="pre">t</span></code> to rewrite the hypothesis <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">:</span> <span class="pre">tuple</span> <span class="pre">&#945;</span> <span class="pre">n</span></code> to <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">:</span> <span class="pre">tuple</span> <span class="pre">&#945;</span> <span class="pre">0</span></code>.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=def%20tuple%20(%CE%B1%20%3A%20Type*)%20(n%20%3A%20%E2%84%95)%20%3A%3D%0A%20%20%7B%20l%20%3A%20list%20%CE%B1%20%2F%2F%20list.length%20l%20%3D%20n%20%7D%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20%7Bn%20%3A%20%E2%84%95%7D%0A%0Aexample%20(h%20%3A%20n%20%3D%200)%20(t%20%3A%20tuple%20%CE%B1%20n)%20%3A%20tuple%20%CE%B1%200%20%3A%3D%0Abegin%0A%20%20rw%20h%20at%20t%2C%0A%20%20exact%20t%0Aend" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">def</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="o">(</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="bp">//</span><span class="w"> </span><span class="n">list.length</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">}</span>

<span class="kd">variables</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">&#945;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">t</span><span class="o">,</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="n">t</span>
<span class="kd">end</span>
</pre></div>
</div>
</div><p>Note that the rewrite tactic can carry out generic calculations in any algebraic structure. The following examples involve an arbitrary ring and an arbitrary group, respectively.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20algebra.ring%0A%0Aexample%20%7B%CE%B1%20%3A%20Type*%7D%20%5Bring%20%CE%B1%5D%20(a%20b%20c%20%3A%20%CE%B1)%20%3A%0A%20%20a%20*%200%20%2B%200%20*%20b%20%2B%20c%20*%200%20%2B%200%20*%20a%20%3D%200%20%3A%3D%0Abegin%0A%20%20rw%20%5Bmul_zero%2C%20mul_zero%2C%20zero_mul%2C%20zero_mul%5D%2C%0A%20%20repeat%20%7B%20rw%20add_zero%20%7D%0Aend%0A%0Aexample%20%7B%CE%B1%20%3A%20Type*%7D%20%5Bgroup%20%CE%B1%5D%20%7Ba%20b%20%3A%20%CE%B1%7D%20(h%20%3A%20a%20*%20b%20%3D%201)%20%3A%0A%20%20a%E2%81%BB%C2%B9%20%3D%20b%20%3A%3D%0Aby%20rw%20%5B%E2%86%90(mul_one%20a%E2%81%BB%C2%B9)%2C%20%E2%86%90h%2C%20inv_mul_cancel_left%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">algebra.ring</span>

<span class="kd">example</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">[</span><span class="n">ring</span><span class="w"> </span><span class="n">&#945;</span><span class="o">]</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">mul_zero</span><span class="o">,</span><span class="w"> </span><span class="n">mul_zero</span><span class="o">,</span><span class="w"> </span><span class="n">zero_mul</span><span class="o">,</span><span class="w"> </span><span class="n">zero_mul</span><span class="o">],</span>
<span class="w">  </span><span class="n">repeat</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="n">add_zero</span><span class="w"> </span><span class="o">}</span>
<span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">[</span><span class="n">group</span><span class="w"> </span><span class="n">&#945;</span><span class="o">]</span><span class="w"> </span><span class="o">{</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">a</span><span class="bp">&#8315;&#185;</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="bp">&#8592;</span><span class="o">(</span><span class="n">mul_one</span><span class="w"> </span><span class="n">a</span><span class="bp">&#8315;&#185;</span><span class="o">),</span><span class="w"> </span><span class="bp">&#8592;</span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">inv_mul_cancel_left</span><span class="o">]</span>
</pre></div>
</div>
</div><p>Using the type class mechanism described in <a class="reference internal" href="type_classes.html#type-classes"><span class="std std-numref">Chapter 10</span></a>, Lean identifies both abstract and concrete instances of the relevant algebraic structures, and instantiates the relevant facts accordingly.</p>
</section>
<section id="using-the-simplifier">
<span id="id4"></span><h2><span class="section-number">5.7. </span>Using the Simplifier<a class="headerlink" href="#using-the-simplifier" title="Link to this heading">&#182;</a></h2>
<p>Whereas <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> is designed as a surgical tool for manipulating a goal, the simplifier offers a more powerful form of automation. A number of identities in Lean&#8217;s library have been tagged with the <code class="docutils literal notranslate"><span class="pre">[simp]</span></code> attribute, and the <code class="docutils literal notranslate"><span class="pre">simp</span></code> tactic uses them to iteratively rewrite subterms in an expression.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0Avariables%20(x%20y%20z%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%0Avariable%20%20(h%20%3A%20p%20(x%20*%20y))%0A%0Aexample%20%3A%20(x%20%2B%200)%20*%20(0%20%2B%20y%20*%201%20%2B%20z%20*%200)%20%3D%20x%20*%20y%20%3A%3D%0Aby%20simp%0A%0Ainclude%20h%0Aexample%20%3A%20p%20((x%20%2B%200)%20*%20(0%20%2B%20y%20*%201%20%2B%20z%20*%200))%20%3A%3D%0Aby%20%7B%20simp%2C%20assumption%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.nat.basic</span>

<span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="kd">variable</span><span class="w">  </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="o">))</span>

<span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kn">include</span><span class="w"> </span><span class="n">h</span>
<span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">((</span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">0</span><span class="o">))</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>In the first example, the left-hand side of the equality in the goal is simplified using the usual identities involving 0 and 1, reducing the goal to <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span></code>. At that point, <code class="docutils literal notranslate"><span class="pre">simp</span></code> applies reflexivity to finish it off. In the second example, <code class="docutils literal notranslate"><span class="pre">simp</span></code> reduces the goal to <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">(x</span> <span class="pre">*</span> <span class="pre">y)</span></code>, at which point the assumption <code class="docutils literal notranslate"><span class="pre">h</span></code> finishes it off. (Remember that we have to <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">h</span></code> explicitly because it is not explicitly mentioned.) Here are some more examples with lists:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Avariable%20%7B%CE%B1%20%3A%20Type*%7D%0A%0Aopen%20list%0A%0Aexample%20(xs%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20%5B1%2C%202%2C%203%5D)%20%3D%20%5B3%2C%202%2C%201%5D%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%0A%0Aexample%20(xs%20ys%20%3A%20list%20%CE%B1)%20%3A%0A%20%20length%20(reverse%20(xs%20%2B%2B%20ys))%20%3D%20length%20xs%20%2B%20length%20ys%20%3A%3D%0Aby%20simp%20%5Badd_comm%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.list.basic</span>

<span class="kd">variable</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">open</span><span class="w"> </span><span class="n">list</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">])</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="o">[</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">length</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">ys</span><span class="o">))</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">add_comm</span><span class="o">]</span>
</pre></div>
</div>
</div><p>This example uses facts about lists that are found in Lean&#8217;s <a class="reference external" href="https://github.com/leanprover/mathlib">mathematics library</a>, which we need to explicitly <cite>import</cite>.</p>
<p>As with <code class="docutils literal notranslate"><span class="pre">rw</span></code>, you can use the keyword <code class="docutils literal notranslate"><span class="pre">at</span></code> to simplify a hypothesis:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0A--%20BEGIN%0Avariables%20(x%20y%20z%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%0A%0Aexample%20(h%20%3A%20p%20((x%20%2B%200)%20*%20(0%20%2B%20y%20*%201%20%2B%20z%20*%200)))%20%3A%0A%20%20p%20(x%20*%20y)%20%3A%3D%0Aby%20%7B%20simp%20at%20h%2C%20assumption%20%7D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">((</span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">0</span><span class="o">)))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>Moreover, you can use a &#8220;wildcard&#8221; asterisk to simplify all the hypotheses and the goal:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0A--%20BEGIN%0Avariables%20(w%20x%20y%20z%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%0A%0Alocal%20attribute%20%5Bsimp%5D%20mul_comm%20mul_assoc%20mul_left_comm%0Alocal%20attribute%20%5Bsimp%5D%20add_assoc%20add_comm%20add_left_comm%0A%0Aexample%20(h%20%3A%20p%20(x%20*%20y%20%2B%20z%20*%20w%20%20*%20x))%20%3A%20p%20(x%20*%20w%20*%20z%20%2B%20y%20*%20x)%20%3A%3D%0Aby%20%7B%20simp%20at%20*%2C%20assumption%20%7D%0A%0Aexample%20(h%E2%82%81%20%3A%20p%20(1%20*%20x%20%2B%20y))%20(h%E2%82%82%20%3A%20p%20%20(x%20*%20z%20*%201))%20%3A%0A%20%20p%20(y%20%2B%200%20%2B%20x)%20%E2%88%A7%20p%20(z%20*%20x)%20%3A%3D%0Aby%20%7B%20simp%20at%20*%2C%20split%3B%20assumption%20%7D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">w</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>

<span class="kn">local</span><span class="w"> </span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">mul_comm</span><span class="w"> </span><span class="n">mul_assoc</span><span class="w"> </span><span class="n">mul_left_comm</span>
<span class="kn">local</span><span class="w"> </span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">add_assoc</span><span class="w"> </span><span class="n">add_comm</span><span class="w"> </span><span class="n">add_left_comm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w">  </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="o">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="bp">*</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="mi">1</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="o">))</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w">  </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="mi">1</span><span class="o">))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="bp">*</span><span class="o">,</span><span class="w"> </span><span class="n">split</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>For operations that are commutative and associative, like multiplication on the natural numbers, the simplifier uses these two facts to rewrite an expression, as well as <em>left commutativity</em>. In the case of multiplication the latter is expressed as follows: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">(y</span> <span class="pre">*</span> <span class="pre">z)</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">*</span> <span class="pre">(x</span> <span class="pre">*</span> <span class="pre">z)</span></code>. The <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">attribute</span></code> command tells the simplifier to use these rules in the current file (or section or namespace, as the case may be). It may seem that commutativity and left-commutativity are problematic, in that repeated application of either causes looping. But the simplifier detects identities that permute their arguments, and uses a technique known as <em>ordered rewriting</em>. This means that the system maintains an internal ordering of terms, and only applies the identity if doing so decreases the order. With the three identities mentioned above, this has the effect that all the parentheses in an expression are associated to the right, and the expressions are ordered in a canonical (though somewhat arbitrary) way. Two expressions that are equivalent up to associativity and commutativity are then rewritten to the same canonical form.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0Avariables%20(x%20y%20z%20w%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%0A%0Alocal%20attribute%20%5Bsimp%5D%20mul_comm%20mul_assoc%20mul_left_comm%0Alocal%20attribute%20%5Bsimp%5D%20add_assoc%20add_comm%20add_left_comm%0A%0A--%20BEGIN%0Aexample%20%3A%20x%20*%20y%20%2B%20z%20*%20w%20%20*%20x%20%3D%20x%20*%20w%20*%20z%20%2B%20y%20*%20x%20%3A%3D%0Aby%20simp%0A%0Aexample%20(h%20%3A%20p%20(x%20*%20y%20%2B%20z%20*%20w%20%20*%20x))%20%3A%20p%20(x%20*%20w%20*%20z%20%2B%20y%20*%20x)%20%3A%3D%0Abegin%20simp%2C%20simp%20at%20h%2C%20assumption%20end%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w">  </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w">  </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="o">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span><span class="w"> </span><span class="n">simp</span><span class="o">,</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="kd">end</span>
</pre></div>
</div>
</div><p>As with the rewriter, the simplifier behaves appropriately in algebraic structures:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20algebra.ring%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20%5Bcomm_ring%20%CE%B1%5D%0A%0Alocal%20attribute%20%5Bsimp%5D%20mul_comm%20mul_assoc%20mul_left_comm%0Alocal%20attribute%20%5Bsimp%5D%20add_assoc%20add_comm%20add_left_comm%0A%0Aexample%20(x%20y%20z%20%3A%20%CE%B1)%20%3A%20(x%20-%20x)%20*%20y%20%2B%20z%20%3D%20z%20%3A%3D%0Abegin%20simp%20end%0A%0Aexample%20(x%20y%20z%20w%20%3A%20%CE%B1)%20%3A%20x%20*%20y%20%2B%20z%20*%20w%20%20*%20x%20%3D%20x%20*%20w%20*%20z%20%2B%20y%20*%20x%20%3A%3D%0Aby%20simp" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">algebra.ring</span>

<span class="kd">variables</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">[</span><span class="n">comm_ring</span><span class="w"> </span><span class="n">&#945;</span><span class="o">]</span>

<span class="kn">local</span><span class="w"> </span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">mul_comm</span><span class="w"> </span><span class="n">mul_assoc</span><span class="w"> </span><span class="n">mul_left_comm</span>
<span class="kn">local</span><span class="w"> </span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">add_assoc</span><span class="w"> </span><span class="n">add_comm</span><span class="w"> </span><span class="n">add_left_comm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="bp">-</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">begin</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="kd">end</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w">  </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>
</pre></div>
</div>
</div><p>As with <code class="docutils literal notranslate"><span class="pre">rewrite</span></code>, you can send <code class="docutils literal notranslate"><span class="pre">simp</span></code> a list of facts to use, including general lemmas, local hypotheses, definitions to unfold, and compound expressions. The <code class="docutils literal notranslate"><span class="pre">simp</span></code> tactic does not recognize the <code class="docutils literal notranslate"><span class="pre">&#8592;t</span></code> syntax that <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> does, so to use an identity in the other direction you need to use <code class="docutils literal notranslate"><span class="pre">eq.symm</span></code> explicitly. In any case, the additional rules are added to the collection of identities that are used to simplify a term.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=def%20f%20(m%20n%20%3A%20%E2%84%95)%20%3A%20%E2%84%95%20%3A%3D%20m%20%2B%20n%20%2B%20m%0A%0Aexample%20%7Bm%20n%20%3A%20%E2%84%95%7D%20(h%20%3A%20n%20%3D%201)%20(h'%20%3A%200%20%3D%20m)%20%3A%20(f%20m%20n)%20%3D%20n%20%3A%3D%0Aby%20simp%20%5Bh%2C%20h'.symm%2C%20f%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">def</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">(</span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span>

<span class="kd">example</span><span class="w"> </span><span class="o">{</span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">m</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">h&#39;.symm</span><span class="o">,</span><span class="w"> </span><span class="n">f</span><span class="o">]</span>
</pre></div>
</div>
</div><p>A common idiom is to simplify a goal using local hypotheses:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(k%20%3A%20%E2%84%95)%0A%0Aexample%20(h%E2%82%81%20%3A%20f%200%20%3D%200)%20(h%E2%82%82%20%3A%20k%20%3D%200)%20%3A%20f%20k%20%3D%200%20%3A%3D%0Aby%20simp%20%5Bh%E2%82%81%2C%20h%E2%82%82%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">h&#8321;</span><span class="o">,</span><span class="w"> </span><span class="n">h&#8322;</span><span class="o">]</span>
</pre></div>
</div>
</div><p>To use all the hypotheses present in the local context when simplifying, we can use the wildcard symbol, <code class="docutils literal notranslate"><span class="pre">*</span></code>:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(f%20%3A%20%E2%84%95%20%E2%86%92%20%E2%84%95)%20(k%20%3A%20%E2%84%95)%0A%0A--%20BEGIN%0Aexample%20(h%E2%82%81%20%3A%20f%200%20%3D%200)%20(h%E2%82%82%20%3A%20k%20%3D%200)%20%3A%20f%20k%20%3D%200%20%3A%3D%0Aby%20simp%20*%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="bp">*</span>
</pre></div>
</div>
</div><p>Here is another example:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0Aexample%20(u%20w%20x%20y%20z%20%3A%20%E2%84%95)%20(h%E2%82%81%20%3A%20x%20%3D%20y%20%2B%20z)%20(h%E2%82%82%20%3A%20w%20%3D%20u%20%2B%20x)%20%3A%0A%20%20w%20%3D%20z%20%2B%20y%20%2B%20u%20%3A%3D%0Aby%20simp%20%5B*%2C%20add_assoc%2C%20add_comm%2C%20add_left_comm%5D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.nat.basic</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">u</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">z</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">w</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="w"> </span><span class="n">add_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">add_comm</span><span class="o">,</span><span class="w"> </span><span class="n">add_left_comm</span><span class="o">]</span>
</pre></div>
</div>
</div><p>The simplifier will also do propositional rewriting. For example, using the hypothesis <code class="docutils literal notranslate"><span class="pre">p</span></code>, it rewrites <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&#8743;</span> <span class="pre">q</span></code> to <code class="docutils literal notranslate"><span class="pre">q</span></code> and <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&#8744;</span> <span class="pre">q</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>, which it then proves trivially. Iterating such rewrites produces nontrivial propositional reasoning.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=variables%20(p%20q%20r%20%3A%20Prop)%0A%0Aexample%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A7%20q%20%E2%86%94%20q%20%3A%3D%0Aby%20simp%20*%0A%0Aexample%20(hp%20%3A%20p)%20%3A%20p%20%E2%88%A8%20q%20%3A%3D%0Aby%20simp%20*%0A%0Aexample%20(hp%20%3A%20p)%20(hq%20%3A%20q)%20%3A%20p%20%E2%88%A7%20(q%20%E2%88%A8%20r)%20%3A%3D%0Aby%20simp%20*" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8596;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="bp">*</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="bp">*</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="bp">*</span>
</pre></div>
</div>
</div><p>The next example simplifies all the hypotheses, and then uses them to prove the goal.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.nat.basic%0A%0Avariables%20(u%20w%20x%20x'%20y%20y'%20z%20%3A%20%E2%84%95)%20(p%20%3A%20%E2%84%95%20%E2%86%92%20Prop)%0A%0Aexample%20(h%E2%82%81%20%3A%20x%20%2B%200%20%3D%20x')%20(h%E2%82%82%20%3A%20y%20%2B%200%20%3D%20y')%20%3A%0A%20%20x%20%2B%20y%20%2B%200%20%3D%20x'%20%2B%20y'%20%3A%3D%0Aby%20%7B%20simp%20at%20*%2C%20simp%20*%20%7D" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.nat.basic</span>

<span class="kd">variables</span><span class="w"> </span><span class="o">(</span><span class="n">u</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">x&#39;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">y&#39;</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8321;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h&#8322;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x&#39;</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">y&#39;</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="bp">*</span><span class="o">,</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>One thing that makes the simplifier especially useful is that its capabilities can grow as a library develops. For example, suppose we define a list operation that symmetrizes its input by appending its reversal:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="n">data.list.basic</span>

<span class="kn">open</span><span class="w"> </span><span class="n">list</span>

<span class="kd">variables</span><span class="w"> </span><span class="o">{</span><span class="n">&#945;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="n">zs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span>

<span class="kd">def</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span>
</pre></div>
</div>
</div><p>Then for any list <code class="docutils literal notranslate"><span class="pre">xs</span></code>, <code class="docutils literal notranslate"><span class="pre">reverse</span> <span class="pre">(mk_symm</span> <span class="pre">xs)</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">mk_symm</span> <span class="pre">xs</span></code>, which can easily be proved by unfolding the definition:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0A--%20BEGIN%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20%7B%20unfold%20mk_symm%2C%20simp%20%7D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">unfold</span><span class="w"> </span><span class="n">mk_symm</span><span class="o">,</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div><p>Or even more simply,</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0A--%20BEGIN%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">mk_symm</span><span class="o">]</span>
</pre></div>
</div>
</div><p>We can now use this theorem to prove new results:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A%0A--%20BEGIN%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%20%5Breverse_mk_symm%5D%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20%5Breverse_mk_symm%5D%20at%20h%3B%20assumption%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_mk_symm</span><span class="o">]</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_mk_symm</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>But using <code class="docutils literal notranslate"><span class="pre">reverse_mk_symm</span></code> is generally the right thing to do, and it would be nice if users did not have to invoke it explicitly. We can achieve that by marking it as a simplification rule when the theorem is defined:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0A--%20BEGIN%0A%40%5Bsimp%5D%20theorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20at%20h%3B%20assumption%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span><span class="w"> </span><span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">mk_symm</span><span class="o">]</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>The notation <code class="docutils literal notranslate"><span class="pre">&#64;[simp]</span></code> declares <code class="docutils literal notranslate"><span class="pre">reverse_mk_symm</span></code> to have the <code class="docutils literal notranslate"><span class="pre">[simp]</span></code> attribute, and can be spelled out more explicitly:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0A--%20BEGIN%0Aattribute%20%5Bsimp%5D%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A--%20END%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20at%20h%3B%20assumption" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">mk_symm</span><span class="o">]</span>
</pre></div>
</div>
</div><p>The attribute can also be applied any time after the theorem is declared:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0A--%20BEGIN%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A%0Aattribute%20%5Bsimp%5D%20reverse_mk_symm%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20at%20h%3B%20assumption%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_mk_symm</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#945;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">mk_symm</span><span class="o">]</span>

<span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">reverse_mk_symm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>Once the attribute is applied, however, there is no way to remove it; it persists in any file that imports the one where the attribute is assigned. As we will discuss further in <a class="reference internal" href="interacting_with_lean.html#attributes"><span class="std std-numref">Section 6.4</span></a>, one can limit the scope of an attribute to the current file or section using the <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">attribute</span></code> command:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A%0A--%20BEGIN%0Asection%0Alocal%20attribute%20%5Bsimp%5D%20reverse_mk_symm%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20at%20h%3B%20assumption%0A%0Aend%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">section</span>
<span class="kn">local</span><span class="w"> </span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">reverse_mk_symm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>

<span class="kd">end</span>
</pre></div>
</div>
</div><p>Outside the section, the simplifier will no longer use <code class="docutils literal notranslate"><span class="pre">reverse_mk_symm</span></code> by default.</p>
<p>You can even create your own sets of simplifier rules, to be applied in special situations.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Aby%20simp%20%5Bmk_symm%5D%0A%0A--%20BEGIN%0Arun_cmd%20mk_simp_attr%20%60my_simps%0A%0Aattribute%20%5Bmy_simps%5D%20reverse_mk_symm%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20%3A%0A%20%20reverse%20(xs%20%2B%2B%20mk_symm%20ys)%20%3D%20mk_symm%20ys%20%2B%2B%20reverse%20xs%20%3A%3D%0Aby%20simp%20with%20my_simps%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20simp%20with%20my_simps%20at%20h%3B%20assumption%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">run_cmd</span><span class="w"> </span><span class="n">mk_simp_attr</span><span class="w"> </span><span class="ss">`my_simps</span>

<span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">my_simps</span><span class="o">]</span><span class="w"> </span><span class="n">reverse_mk_symm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">my_simps</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">  </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">my_simps</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="bp">;</span><span class="w"> </span><span class="n">assumption</span>
</pre></div>
</div>
</div><p>The command <code class="docutils literal notranslate"><span class="pre">run_cmd</span> <span class="pre">mk_simp_attr</span> <span class="pre">`my_simps</span></code> creates a new attribute <code class="docutils literal notranslate"><span class="pre">[my_simps]</span></code>. (The backtick is used to indicate that <code class="docutils literal notranslate"><span class="pre">my_simps</span></code> is a new name, something that is explained more fully in <a class="reference external" href="https://leanprover.github.io/programming_in_lean/">Programming in Lean</a>.) The command <code class="docutils literal notranslate"><span class="pre">simp</span> <span class="pre">with</span> <span class="pre">my_simps</span></code> then adds all the theorems that have been marked with attribute <code class="docutils literal notranslate"><span class="pre">[my_simps]</span></code> to the default set of theorems marked with attribute <code class="docutils literal notranslate"><span class="pre">[simp]</span></code> before applying <code class="docutils literal notranslate"><span class="pre">[simp]</span></code>, and similarly with <code class="docutils literal notranslate"><span class="pre">simp</span> <span class="pre">with</span> <span class="pre">my_simps</span> <span class="pre">at</span> <span class="pre">h</span></code>.</p>
<p>Note that the various <code class="docutils literal notranslate"><span class="pre">simp</span></code> options we have discussed &#8212; giving an explicit list of rules, using <code class="docutils literal notranslate"><span class="pre">at</span></code> to specify the location, and using <code class="docutils literal notranslate"><span class="pre">with</span></code> to add additional simplifier rules &#8212; can be combined, but the order they are listed is rigid. You can see the correct order in an editor by placing the cursor on the <code class="docutils literal notranslate"><span class="pre">simp</span></code> identifier to see the documentation string that is associated with it.</p>
<p>There are two additional modifiers that are useful. By default, <code class="docutils literal notranslate"><span class="pre">simp</span></code> includes all theorems that have been marked with the attribute <code class="docutils literal notranslate"><span class="pre">[simp]</span></code>. Writing <code class="docutils literal notranslate"><span class="pre">simp</span> <span class="pre">only</span></code> excludes these defaults, allowing you to use a more explicitly crafted list of rules. Alternatively, writing <code class="docutils literal notranslate"><span class="pre">simp</span> <span class="pre">without</span> <span class="pre">t</span></code> filters <code class="docutils literal notranslate"><span class="pre">t</span></code> and removes it from the set of simplification rules. In the examples below, the minus sign and <code class="docutils literal notranslate"><span class="pre">only</span></code> are used to block the application of <code class="docutils literal notranslate"><span class="pre">reverse_mk_symm</span></code>.</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20data.list.basic%0A%0Aopen%20list%0A%0Avariables%20%7B%CE%B1%20%3A%20Type*%7D%20(x%20y%20z%20%3A%20%CE%B1)%20(xs%20ys%20zs%20%3A%20list%20%CE%B1)%0A%0Adef%20mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%3D%20xs%20%2B%2B%20reverse%20xs%0A%0Atheorem%20reverse_mk_symm%20(xs%20%3A%20list%20%CE%B1)%20%3A%0A%20%20reverse%20(mk_symm%20xs)%20%3D%20mk_symm%20xs%20%3A%3D%0Abegin%20unfold%20mk_symm%2C%20simp%20end%0A%0A--%20BEGIN%0Aattribute%20%5Bsimp%5D%20reverse_mk_symm%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(mk_symm%20ys%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20%7B%20simp%20at%20h%2C%20assumption%20%7D%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(reverse%20(mk_symm%20ys)%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20%7B%20simp%20%5B-reverse_mk_symm%5D%20at%20h%2C%20assumption%20%7D%0A%0Aexample%20(xs%20ys%20%3A%20list%20%E2%84%95)%20(p%20%3A%20list%20%E2%84%95%20%E2%86%92%20Prop)%0A%20%20%20%20(h%20%3A%20p%20(reverse%20(xs%20%2B%2B%20(mk_symm%20ys))))%20%3A%0A%20%20p%20(reverse%20(mk_symm%20ys)%20%2B%2B%20reverse%20xs)%20%3A%3D%0Aby%20%7B%20simp%20only%20%5Breverse_append%5D%20at%20h%2C%20assumption%20%7D%0A--%20END" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kn">attribute</span><span class="w"> </span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="n">reverse_mk_symm</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="bp">-</span><span class="n">reverse_mk_symm</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">&#8469;</span><span class="w"> </span><span class="bp">&#8594;</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">xs</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">))))</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">mk_symm</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_append</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">assumption</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div></section>
<section id="exercises">
<h2><span class="section-number">5.8. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">&#182;</a></h2>
<ol class="arabic">
<li><p>Go back to the exercises in <a class="reference internal" href="propositions_and_proofs.html#propositions-and-proofs"><span class="std std-numref">Chapter 3</span></a> and <a class="reference internal" href="quantifiers_and_equality.html#quantifiers-and-equality"><span class="std std-numref">Chapter 4</span></a> and redo as many as you can now with tactic proofs, using also <code class="docutils literal notranslate"><span class="pre">rw</span></code> and <code class="docutils literal notranslate"><span class="pre">simp</span></code> as appropriate.</p></li>
<li><p>Use tactic combinators to obtain a one line proof of the following:</p>
<div style="position: relative">
<div style='position: absolute; right: 0; top: 0; padding: 1ex'><a href="https://leanprover-community.github.io/lean-web-editor/#code=example%20(p%20q%20r%20%3A%20Prop)%20(hp%20%3A%20p)%20%3A%0A(p%20%E2%88%A8%20q%20%E2%88%A8%20r)%20%E2%88%A7%20(q%20%E2%88%A8%20p%20%E2%88%A8%20r)%20%E2%88%A7%20(q%20%E2%88%A8%20r%20%E2%88%A8%20p)%20%3A%3D%0Aby%20sorry" target="_blank">
try it!</a></div><div class="highlight-lean notranslate"><div class="highlight"><pre><span></span><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">hp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="o">(</span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="o">)</span><span class="w"> </span><span class="bp">&#8743;</span><span class="w"> </span><span class="o">(</span><span class="n">q</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="bp">&#8744;</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="kd">by</span><span class="w"> </span><span class="gr">sorry</span>
</pre></div>
</div>
</div></li>
</ol>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Theorem Proving in Lean 3 (outdated)</a></h1>








<!-- <h3>Navigation</h3> -->
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependent_type_theory.html">2. Dependent Type Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="propositions_and_proofs.html">3. Propositions and Proofs</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantifiers_and_equality.html">4. Quantifiers and Equality</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Tactics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#entering-tactic-mode">5.1. Entering Tactic Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-tactics">5.2. Basic Tactics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-tactics">5.3. More Tactics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structuring-tactic-proofs">5.4. Structuring Tactic Proofs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tactic-combinators">5.5. Tactic Combinators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rewriting">5.6. Rewriting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-simplifier">5.7. Using the Simplifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">5.8. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interacting_with_lean.html">6. Interacting with Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="inductive_types.html">7. Inductive Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="induction_and_recursion.html">8. Induction and Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="structures_and_records.html">9. Structures and Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="type_classes.html">10. Type Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="axioms_and_computation.html">11. Axioms and Computation</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="theorem_proving_in_lean.pdf">PDF version</a></li>
    
    <li class="toctree-l1"><a href="https://leanprover.github.io/">Lean Home</a></li>
    
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2017, Jeremy Avigad, Leonardo de Moura, and Soonho Kong.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/tactics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>